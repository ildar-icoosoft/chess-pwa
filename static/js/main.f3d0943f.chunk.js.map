{"version":3,"sources":["features/ongoing-games/GamePreviewsList.module.scss","normalizr/schemas/gameSchema.ts","services/ioClient.ts","features/current-user/currentUserSlice.ts","utils/makeChessInstance.ts","features/ongoing-games/GamePreviewsList.tsx","features/ongoing-games/OngoingGamesContainer.tsx","features/challenge-ai-modal/ChallengeAiForm.tsx","features/challenge-ai-modal/ChallengeAiFormContainer.tsx","pages/HomePage.tsx","features/single-game/GameMeta.tsx","utils/getGameStatusText.ts","features/single-game/GameClock.tsx","features/single-game/GameMoves.tsx","features/single-game/GameControlPanelUserName.tsx","features/single-game/GameControlPanelTopToolbar.tsx","features/single-game/GameControlPanelBottomToolbar.tsx","features/single-game/GameControlPanel.tsx","features/single-game/SingleGame.tsx","features/single-game/SingleGameContainer.tsx","pages/GamePage.tsx","features/auth-modal/LoginForm.tsx","features/auth-modal/RegistrationForm.tsx","features/auth-modal/LoginTabsContainer.tsx","app/App.tsx","serviceWorker.ts","features/entities/entitiesSlice.ts","app/rootReducer.ts","app/store.ts","index.tsx","normalizr/schemas/userSchema.ts","features/challenge-ai-modal/ChallengeAiForm.module.scss","features/challenge/challengeSlice.ts","features/data-subscription/dataSubscriptionSlice.ts","features/ongoing-games/ongoingGamesSlice.ts","features/single-game/singleGameSlice.ts","features/auth-modal/authModalSlice.ts","features/challenge-ai-modal/challengeAiModalSlice.ts","features/move/moveSlice.ts","features/game-clock/gameClockSlice.ts"],"names":["module","exports","gameSchema","schema","Entity","white","userSchema","black","ioClient","sailsIOClient","socketIOClient","sails","url","currentUserSlice","createSlice","name","initialState","userId","isLoading","error","reducers","getCurrentUserRequest","state","getCurrentUserSuccess","action","payload","result","getCurrentUserError","loginSuccess","registerSuccess","logoutSuccess","actions","fetchCurrentUser","dispatch","Promise","resolve","reject","socket","get","body","jwr","statusCode","normalizedUser","normalize","login","data","put","rememberMe","emailAddress","email","password","register","post","fullName","confirmPassword","agreed","logout","game","initialFen","chess","Chess","moves","split","forEach","move","sloppy","Error","GamePreviewsList","games","className","css","grid","map","item","fen","makeChessInstance","to","id","key","cell","position","viewOnly","width","OngoingGamesContainer","useDispatch","items","useSelector","denormalize","ongoingGames","entities","useEffect","fetchOngoingGames","ChallengeAiForm","onSubmit","initialValues","level","color","clockLimit","clockIncrement","values","formikHelpers","handleChange","handleBlur","handleSubmit","isSubmitting","status","setStatus","setFieldValue","Form","noValidate","e","onChange","Alert","variant","Group","Label","Control","type","onBlur","value","min","max","step","Row","ButtonGroup","cx","levelButtonGroup","Button","onClick","colorSubmits","disabled","title","colorSubmitsButton","blackButton","randomButton","whiteButton","ChallengeAiFormContainer","history","useHistory","challengeAiAndOpenGamePage","useCallback","challengeAi","then","push","catch","err","HomePage","isChallengeAiModalVisible","challengeAiModal","Modal","show","onHide","hideChallengeAiModal","animation","Header","closeButton","Title","Body","showChallengeAiModal","GameMeta","winner","getGameStatusText","data-testid","aiLevel","GameClock","time","formattedTime","moment","startOf","milliseconds","format","formatMove","from","GameMoves","onRewindToMove","movesHistory","verbose","movesPairs","_chunk","makeRewindToMoveHandler","moveIndex","pair","index","role","GameControlPanelUserName","GameControlPanelTopToolbar","onFlipBoard","onRewindToPrevMove","onRewindToNextMove","onRewindToFirstMove","onRewindToLastMove","handleFlipBoard","handleRewindToPrevMove","handleRewindToNextMove","handleRewindToFirstMove","handleRewindToLastMove","GameControlPanelBottomToolbar","onAbortGame","onOfferDraw","onResignGame","handleAbortGame","handleOfferDraw","handleResignGame","GameControlPanel","orientation","btime","wtime","SingleGame","currentUser","onMove","movableColor","check","in_check","turnColor","turn","PieceColor","WHITE","BLACK","validMoves","getValidMoves","lastMoveSquares","length","lastMove","allowMarkers","clickable","draggable","SingleGameContainer","fetchGame","makeMove","GamePage","useParams","Number","loginSchema","Yup","shape","required","LoginForm","validationSchema","errors","touched","placeholder","isValid","isInvalid","Feedback","registrationSchema","equals","RegistrationForm","LoginTabsContainer","doLogin","React","doSignUp","Tabs","transition","Tab","eventKey","App","isAuthModalVisible","authModal","watchGames","startGameClock","showAuthModal","hideAuthModal","path","Boolean","window","location","hostname","match","getNormalizedDataReducer","Object","assign","users","entitiesSlice","extraReducers","getOngoingGamesSuccess","getSingleGameSuccess","challengeAiSuccess","updateGameBySubscription","createGameBySubscription","makeMoveRequest","gameId","trim","makeMoveSuccess","oneSecondPassed","keys","timePropName","rootReducer","combineReducers","authModalReducer","challengeAiModalReducer","currentUserReducer","ongoingGamesReducer","entitiesReducer","singleGame","singleGameReducer","store","configureStore","reducer","require","default","ReactDOM","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","console","message","challengeSlice","challengeAiRequest","_state","_action","challengeAiError","normalizedGame","dataSubscriptionSlice","on","subscriptionData","verb","previous","ongoingGamesSlice","getOngoingGamesRequest","getOngoingGamesError","includes","unshift","normalizedGames","singleGameSlice","getSingleGameRequest","getSingleGameError","itemId","authModalSlice","challengeAiModalSlice","moveSlice","makeMoveError","gameClockSlice","setInterval"],"mappings":"iGACAA,EAAOC,QAAU,CAAC,KAAO,iC,sECDzB,mBAGMC,EAAa,IAAIC,IAAOC,OAAO,QAAS,CAC5CC,MAAOC,IACPC,MAAOD,MAGMJ,O,sDCRf,+BAGMM,EAHN,MAGiBC,GAAcC,KAE/BF,EAASG,MAAMC,IAAM,wBAENJ,O,gCCPf,gRA0BMK,EAAmBC,YAAY,CACnCC,KAAM,cACNC,aARqC,CACrCC,OAAQ,KACRC,WAAW,EACXC,MAAO,MAMPC,SAAU,CACRC,sBADQ,SACcC,GACpBA,EAAMJ,WAAY,EAClBI,EAAMH,MAAQ,MAEhBI,sBALQ,SAMND,EACAE,GAEAF,EAAML,OAASO,EAAOC,QAAUD,EAAOC,QAAQC,OAAS,KACxDJ,EAAMJ,WAAY,EAClBI,EAAMH,MAAQ,MAEhBQ,oBAbQ,SAaYL,EAAOE,GACzBF,EAAMJ,WAAY,EAClBI,EAAMH,MAAQK,EAAOC,SAEvBG,aAjBQ,SAiBKN,EAAOE,GAClBF,EAAML,OAASO,EAAOC,QAAQC,QAEhCG,gBApBQ,SAoBQP,EAAOE,GACrBF,EAAML,OAASO,EAAOC,QAAQC,QAEhCI,cAvBQ,SAuBMR,GACZA,EAAML,OAAS,S,EAYjBJ,EAAiBkB,QANnBV,E,EAAAA,sBACAE,E,EAAAA,sBACAI,E,EAAAA,oBACAC,E,EAAAA,aACAC,E,EAAAA,gBACAC,E,EAAAA,cAGajB,MAAf,QAEO,IAAMmB,EAAmB,kBAAsC,SACpEC,GAIA,OAFAA,EAASZ,KAEF,IAAIa,SAAQ,SAACC,EAASC,GAC3B5B,IAAS6B,OAAOC,IAAI,sBAAsB,SAACC,EAAeC,GACxD,GAAuB,MAAnBA,EAAIC,WAAoB,CAC1B,IAAMC,EAAiBC,YAAUJ,EAAcjC,KAE/C2B,EAASV,EAAsBmB,IAC/BP,EAAQI,QACoB,MAAnBC,EAAIC,YACbR,EAASV,EAAsB,OAC/BY,EAAQ,QAERF,EAASN,EAAoBY,IAC7BH,EAAOI,YAMFI,EAAQ,SAACC,GAAD,OAA8C,SACjEZ,GAEA,OAAO,IAAIC,SAAQ,SAACC,EAASC,GAC3B5B,IAAS6B,OAAOS,IACd,yBACA,CACEC,YAAY,EACZC,aAAcH,EAAKI,MACnBC,SAAUL,EAAKK,WAEjB,SAACX,EAAeC,GACd,GAAuB,MAAnBA,EAAIC,WAAoB,CAC1B,IAAMC,EAAiBC,YAAUJ,EAAcjC,KAE/C2B,EAASL,EAAac,IACtBP,EAAQI,QAERH,EAAOI,WAOJW,EAAW,SAACN,GAAD,OAA+C,SACrEZ,GAEA,OAAO,IAAIC,SAAQ,SAACC,EAASC,GAC3B5B,IAAS6B,OAAOe,KACd,0BACA,CACEC,SAAUR,EAAKQ,SACfL,aAAcH,EAAKI,MACnBC,SAAUL,EAAKK,SACfI,gBAAiBT,EAAKK,SACtBK,QAAQ,IAEV,SAAChB,EAAeC,GACd,GAAuB,MAAnBA,EAAIC,WAAoB,CAC1B,IAAMC,EAAiBC,YAAUJ,EAAcjC,KAE/C2B,EAASJ,EAAgBa,IACzBP,EAAQI,QAERH,EAAOI,WAOJgB,EAAS,kBAA+B,SAACvB,GACpD,OAAO,IAAIC,SAAQ,SAACC,EAASC,GAC3B5B,IAAS6B,OAAOe,KACd,yBACA,IACA,SAACb,EAAeC,GACS,MAAnBA,EAAIC,YACNR,EAASH,KACTK,KAEAC,EAAOI,Y,6KCpJF,WAACiB,GAA+B,IACvCC,EAAeD,EAAfC,WACa,aAAfA,IACFA,EALF,4DAQA,IAAMC,EAAQ,IAAIC,QAAMF,GAcxB,OAZID,EAAKI,OACPJ,EAAKI,MAAMC,MAAM,KAAKC,SAAQ,SAACC,GAK7B,IAJeL,EAAMK,KAAKA,EAAM,CAC9BC,QAAQ,IAIR,MAAMC,MAAM,mBAAD,OAAoBF,OAK9BL,GCfIQ,EAA8C,SAAC,GAAoB,IAAD,IAAjBC,aAAiB,MAAT,GAAS,EAC7E,OACE,yBAAKC,UAAWC,IAAIC,MACjBH,EAAMI,KAAI,SAACC,GACV,IAAMC,EAAcC,EAAkBF,GAAMC,MAE5C,OACE,kBAAC,IAAD,CAAME,GAAE,gBAAWH,EAAKI,IAAMC,IAAKL,EAAKI,IACtC,yBAAKR,UAAWC,IAAIS,MAClB,kBAAC,QAAD,CAAOC,SAAUN,EAAKO,UAAU,EAAOC,MAAO,a,gBCE7CC,EAd4B,WACzC,IAAMlD,EAAWmD,cAEXC,EAAQC,aAAY,SAAChE,GAAD,OACxBiE,YAAYjE,EAAMkE,aAAaH,MAAO,CAACnF,KAAaoB,EAAMmE,aAO5D,OAJAC,qBAAU,WACRzD,EAAS0D,iBACR,CAAC1D,IAEG,kBAAC,EAAD,CAAkBmC,MAAOiB,K,6ECHrBO,EAA4C,SAAC,GAAkB,IAAhBC,EAAe,EAAfA,SAC1D,OACE,kBAAC,IAAD,CACEC,cAAe,CACbC,MAAO,EACPC,MAAO,GACPC,WAAY,IACZC,eAAgB,GAElBL,SAAQ,iHAAE,SAACM,EAAQC,GACjB,GAAIP,EACF,OAAOA,EACLM,EACAC,QAML,gBACCD,EADD,EACCA,OACAE,EAFD,EAECA,aACAC,EAHD,EAGCA,WACAC,EAJD,EAICA,aACAC,EALD,EAKCA,aACAC,EAND,EAMCA,OACAC,EAPD,EAOCA,UACAC,EARD,EAQCA,cARD,OAWC,kBAACC,EAAA,EAAD,CACEC,YAAU,EACVhB,SAAU,SAACiB,GAAD,OAAOP,EAAaO,IAC9BC,SAAU,kBAAML,EAAU,QAEvBD,GAAU,kBAACO,EAAA,EAAD,CAAOC,QAAQ,UAAUR,GACtC,kCACE,kBAACG,EAAA,EAAKM,MAAN,KACE,kBAACN,EAAA,EAAKO,MAAN,0BACqBhB,EAAOF,WAAa,IAEzC,kBAACW,EAAA,EAAKQ,QAAN,CACEC,KAAK,QACLtG,KAAK,aACLuG,OAAQhB,EACRiB,MAAOpB,EAAOF,WACdc,SAAUV,EACVmB,IAAI,KACJC,IAAI,OACJC,KAAK,QAIT,kBAACd,EAAA,EAAKM,MAAN,KACE,kBAACN,EAAA,EAAKO,MAAN,8BACyBhB,EAAOD,gBAEhC,kBAACU,EAAA,EAAKQ,QAAN,CACEC,KAAK,QACLtG,KAAK,iBACLuG,OAAQhB,EACRiB,MAAOpB,EAAOD,eACda,SAAUV,EACVmB,IAAI,IACJC,IAAI,SAKV,yBAAKpD,UAAU,eAAf,SAEA,kBAACsD,EAAA,EAAD,KACE,kBAACC,EAAA,EAAD,CAAavD,UAAWwD,IAAG,UAAWvD,IAAIwD,mBACvC,CAAC,EAAG,EAAG,EAAG,GAAGtD,KAAI,SAACuB,GAAD,OAChB,kBAACgC,EAAA,EAAD,CACEjD,IAAKiB,EACLsB,KAAK,SACLJ,QAASlB,IAAUI,EAAOJ,MAAQ,OAAS,QAC3CiC,QAAS,kBAAMrB,EAAc,QAASZ,KAErCA,QAMT,yBAAK1B,UAAU,eAAf,eAA0C8B,EAAOJ,OAEjD,yBAAK1B,UAAWC,IAAI2D,cAClB,4BACEC,SAAU1B,EACVa,KAAK,SACLc,MAAM,QACN9D,UAAWwD,IAAGvD,IAAI8D,mBAAoB9D,IAAI+D,aAC1CL,QAAS,kBAAMrB,EAAc,QAAS,WAEtC,6BAEF,4BACEuB,SAAU1B,EACVa,KAAK,SACLc,MAAM,cACN9D,UAAWwD,IAAGvD,IAAI8D,mBAAoB9D,IAAIgE,cAC1CN,QAAS,kBAAMrB,EAAc,QAAS,YAEtC,6BAEF,4BACEuB,SAAU1B,EACVa,KAAK,SACLc,MAAM,QACN9D,UAAWwD,IAAGvD,IAAI8D,mBAAoB9D,IAAIiE,aAC1CP,QAAS,kBAAMrB,EAAc,QAAS,WAEtC,mC,QC5FC6B,EA5B+B,WAC5C,IAAMvG,EAAWmD,cAEXqD,EAAUC,cAEVC,EAA6BC,uBACjC,SACEzC,EACAC,GAEA,OAAOnE,EAAS4G,YAAY1C,IACzB2C,MAAK,SAACrF,GACLgF,EAAQM,KAAR,gBAAsBtF,EAAKoB,QAE5BmE,OAAM,SAACC,GACiB,MAAnBA,EAAIxG,WACN2D,EAAcM,UAAU,yCAExBN,EAAcM,UAAU,8BAIhC,CAACzE,EAAUwG,IAGb,OAAO,kBAAC,EAAD,CAAiB5C,SAAU8C,K,QCWrBO,EAjCe,WAC5B,IAAMjH,EAAWmD,cAET+D,EAA8B7D,aACpC,SAAChE,GAAD,OAAsBA,EAAM8H,oBADtBD,0BAIR,OACE,oCACE,kBAACE,EAAA,EAAD,CACEC,KAAMH,EACNI,OAAQ,kBAAMtH,EAASuH,gBACvBC,WAAW,GAEX,kBAACJ,EAAA,EAAMK,OAAP,CAAcC,aAAW,GACvB,kBAACN,EAAA,EAAMO,MAAP,gCAGF,kBAACP,EAAA,EAAMQ,KAAP,KACE,kBAAC,EAAD,QAGJ,kBAAC9B,EAAA,EAAD,CACEd,QAAQ,UACRe,QAAS,kBAAM/F,EAAS6H,iBAF1B,0BAMA,kBAAC,EAAD,QCjCOC,EAA8B,SAAC,GAAc,IAAZtG,EAAW,EAAXA,KAC5C,OAAKA,EAKH,oCACE,6BCbS,SAACA,GACd,GAAoB,cAAhBA,EAAKgD,OAAwB,CAC/B,GAAoB,UAAhBhD,EAAKuG,OACP,MAAO,sCAET,GAAoB,UAAhBvG,EAAKuG,OACP,MAAO,sCAIX,GAAoB,WAAhBvG,EAAKgD,OAAqB,CAC5B,GAAoB,UAAhBhD,EAAKuG,OACP,MAAO,4CAET,GAAoB,UAAhBvG,EAAKuG,OACP,MAAO,4CAIX,GAAoB,YAAhBvG,EAAKgD,OACP,MAAO,eAGT,GAAoB,SAAhBhD,EAAKgD,OAAmB,CAC1B,GAAoB,UAAhBhD,EAAKuG,OACP,MAAO,uCAET,GAAoB,UAAhBvG,EAAKuG,OACP,MAAO,uCAIX,MAAoB,SAAhBvG,EAAKgD,OACA,OAGW,cAAhBhD,EAAKgD,OACA,YAGF,oBD3BGwD,CAAkBxG,IACxB,6BACGA,EAAKwC,WAAa,GADrB,MAC4BxC,EAAKyC,gBAEjC,yBAAKgE,cAAY,cAAjB,UACUzG,EAAKpD,MAAQoD,EAAKpD,MAAMgD,SAAxB,mBAA+CI,EAAK0G,UAE9D,yBAAKD,cAAY,cAAjB,UACUzG,EAAKlD,MAAQkD,EAAKlD,MAAM8C,SAAxB,mBAA+CI,EAAK0G,WAbzD,M,kBEHEC,EAAgC,SAAC,GAAkB,IAAD,IAAfC,YAAe,MAAR,EAAQ,EACvDC,EAAgBC,MACnBC,QAAQ,OACRC,aAAaJ,GACbK,OAAO,WAEV,OAAO,yBAAKR,cAAY,QAAQI,I,QCE5BK,EAAa,SAAC3G,GAClB,MAAM,GAAN,OAAUA,EAAK4G,MAAf,OAAsB5G,EAAKY,KAGhBiG,EAAgC,SAAC,GAA8B,IAA5BpH,EAA2B,EAA3BA,KAAMqH,EAAqB,EAArBA,eACpD,IAAKrH,EACH,OAAO,KAGT,IAEMsH,EAFQpG,EAAkBlB,GAELgF,QAAQ,CAAEuC,SAAS,IAExCC,EAAaC,gBAAOH,EAAc,GAElCI,EAA0B,SAACC,GAC/B,OAAO,WACDN,GACFA,EAAeM,KAKrB,OACE,+BACE,+BACGH,EAAWzG,KAAI,SAAC6G,EAAMC,GAAP,OACd,wBAAIxG,IAAG,eAAUwG,IACf,4BAAKA,EAAQ,GACb,4BACE,yBACEpB,cAAA,eAA6B,EAARoB,GACrBtD,QAASmD,EAAgC,EAARG,GACjCC,KAAK,UAEJZ,EAAWU,EAAK,MAGrB,4BACGA,EAAK,IACJ,yBACEnB,cAAA,eAA6B,EAARoB,EAAY,GACjCtD,QAASmD,EAAgC,EAARG,EAAY,GAC7CC,KAAK,UAEJZ,EAAWU,EAAK,aCjDtBG,EAA8D,SAAC,GAGrE,IAFL/H,EAEI,EAFJA,KAEI,IADJuC,aACI,MADI,QACJ,EACJ,OAAKvC,EAKH,6BACGA,EAAKuC,GAASvC,EAAKuC,GAAQ3C,SAA3B,mBAAkDI,EAAK0G,UALnD,MCNEsB,EAAkE,SAAC,GAMzE,IALLC,EAKI,EALJA,YACAC,EAII,EAJJA,mBACAC,EAGI,EAHJA,mBACAC,EAEI,EAFJA,oBACAC,EACI,EADJA,mBAEMC,EAAkBnD,uBAAY,WAC9B8C,GACFA,MAED,CAACA,IACEM,EAAyBpD,uBAAY,WACrC+C,GACFA,MAED,CAACA,IACEM,EAAyBrD,uBAAY,WACrCgD,GACFA,MAED,CAACA,IACEM,EAA0BtD,uBAAY,WACtCiD,GACFA,MAED,CAACA,IACEM,EAAyBvD,uBAAY,WACrCkD,GACFA,MAED,CAACA,IAEJ,OACE,oCACE,4BACEzE,KAAK,SACL6C,cAAY,iBACZlC,QAAS+D,GAHX,cAOA,4BACE1E,KAAK,SACL6C,cAAY,0BACZlC,QAASgE,GAHX,uBAOA,4BACE3E,KAAK,SACL6C,cAAY,2BACZlC,QAASkE,GAHX,wBAOA,4BACE7E,KAAK,SACL6C,cAAY,0BACZlC,QAASmE,GAHX,uBAOA,4BACE9E,KAAK,SACL6C,cAAY,0BACZlC,QAASiE,GAHX,yBCjEOG,EAAwE,SAAC,GAI/E,IAHLC,EAGI,EAHJA,YACAC,EAEI,EAFJA,YACAC,EACI,EADJA,aAEMC,EAAkB5D,uBAAY,WAC9ByD,GACFA,MAED,CAACA,IACEI,EAAkB7D,uBAAY,WAC9B0D,GACFA,MAED,CAACA,IACEI,EAAmB9D,uBAAY,WAC/B2D,GACFA,MAED,CAACA,IAEJ,OACE,oCACE,4BACElF,KAAK,SACL6C,cAAY,iBACZlC,QAASwE,GAHX,SAOA,4BACEnF,KAAK,SACL6C,cAAY,iBACZlC,QAASyE,GAHX,gBAOA,4BACEpF,KAAK,SACL6C,cAAY,kBACZlC,QAAS0E,GAHX,YCtBOC,EAA8C,SAAC,GAYrD,IAXLlJ,EAWI,EAXJA,KAWI,IAVJmJ,mBAUI,MAVU,QAUV,EATJ9B,EASI,EATJA,eACAY,EAQI,EARJA,YACAC,EAOI,EAPJA,mBACAC,EAMI,EANJA,mBACAC,EAKI,EALJA,oBACAC,EAII,EAJJA,mBACAO,EAGI,EAHJA,YACAC,EAEI,EAFJA,YACAC,EACI,EADJA,aAEA,OAAK9I,EAKH,6BACE,kBAAC,EAAD,CAAW4G,KAAsB,UAAhBuC,EAA0BnJ,EAAKoJ,MAAQpJ,EAAKqJ,QAC7D,kBAAC,EAAD,CACErJ,KAAMA,EACNuC,MAAuB,UAAhB4G,EAA0B,QAAU,UAE7C,kBAAC,EAAD,CACElB,YAAaA,EACbC,mBAAoBA,EACpBC,mBAAoBA,EACpBC,oBAAqBA,EACrBC,mBAAoBA,IAEtB,kBAAC,EAAD,CAAWrI,KAAMA,EAAMqH,eAAgBA,IACvC,kBAAC,EAAD,CACEuB,YAAaA,EACbC,YAAaA,EACbC,aAAcA,IAEhB,kBAAC,EAAD,CACE9I,KAAMA,EACNuC,MAAuB,UAAhB4G,EAA0B,QAAU,UAE7C,kBAAC,EAAD,CAAWvC,KAAsB,UAAhBuC,EAA0BnJ,EAAKqJ,MAAQrJ,EAAKoJ,SA3BxD,MChBEE,EAAkC,SAAC,GAIzC,IAAD,UAHJtJ,EAGI,EAHJA,KACAuJ,EAEI,EAFJA,YACAC,EACI,EADJA,OAEA,IAAKxJ,EACH,OAAO,KAGT,IAoBIyJ,EApBEvJ,EAAuBgB,EAAkBlB,GAEzC0J,EAAiBxJ,EAAMyJ,WAEvB1I,EAAcf,EAAMe,MAEpB2I,EACU,UAAd5J,EAAK6J,KAAmBC,aAAWC,MAAQD,aAAWE,MAElDC,EAAyBC,wBAAchK,GAEzCsB,GAAW,GAEb+H,GACCA,EAAYnI,MAAZ,UAAmBpB,EAAKpD,aAAxB,aAAmB,EAAYwE,KAAMmI,EAAYnI,MAAZ,UAAmBpB,EAAKlD,aAAxB,aAAmB,EAAYsE,KACrD,YAAhBpB,EAAKgD,SAELxB,GAAW,GAIT+H,GAAeA,EAAYnI,MAAZ,UAAmBpB,EAAKpD,aAAxB,aAAmB,EAAYwE,MAChDqI,EAAeK,aAAWC,OAExBR,GAAeA,EAAYnI,MAAZ,UAAmBpB,EAAKlD,aAAxB,aAAmB,EAAYsE,MAChDqI,EAAeK,aAAWE,OAG5B,IAAIb,EAAcW,aAAWC,MACzBR,GAAeA,EAAYnI,MAAZ,UAAmBpB,EAAKlD,aAAxB,aAAmB,EAAYsE,MAChD+H,EAAcW,aAAWE,OAG3B,IAEIG,EAFE7C,EAAepH,EAAM8E,QAAQ,CAAEuC,SAAS,IAG9C,GAAID,EAAa8C,OAAQ,CACvB,IAAMC,EAAW/C,EAAaA,EAAa8C,OAAS,GACpDD,EAAkB,CAACE,EAASlD,KAAMkD,EAASlJ,IAG7C,OACE,oCACE,kBAAC,EAAD,CAAUnB,KAAMA,IAChB,kBAAC,EAAD,CAAkBA,KAAMA,EAAMmJ,YAAaA,IAC3C,kBAAC,QAAD,CACEmB,cAAY,EACZZ,MAAOA,EACPa,WAAS,EACTC,WAAS,EACTrB,YAAaA,EACb5H,SAAUN,EACV2I,UAAWA,EACXO,gBAAiBA,EACjBV,aAAcA,EACdQ,WAAYA,EACZzI,SAAUA,EACVgI,OAAQA,M,wBCtEHiB,EAAoD,SAAC,GAAY,IAAVrJ,EAAS,EAATA,GAC5D5C,EAAWmD,cAEX3B,EAAO6B,aAAY,SAAChE,GAAD,OACvBiE,YAAYV,EAAI3E,IAAYoB,EAAMmE,aAG9BuH,EAAgC1H,aAAY,SAAChE,GACjD,GAAIA,EAAM0L,YAAY/L,OACpB,OAAOsE,YAAYjE,EAAM0L,YAAY/L,OAAQX,IAAYgB,EAAMmE,aAKnEC,qBAAU,WACRzD,EAASkM,YAAUtJ,MAClB,CAAC5C,EAAU4C,IAMd,OAAIpB,EACK,kBAAC,EAAD,CAAYA,KAAMA,EAAMuJ,YAAaA,EAAaC,OAL5C,SAACjJ,GACd/B,EAASmM,YAASvJ,EAAD,UAAQb,EAAK4G,MAAb,OAAoB5G,EAAKY,SAMrC,MC5BMyJ,EANe,WAAO,IAC3BxJ,EAAOyJ,cAAPzJ,GAER,OAAO,kBAAC,EAAD,CAAqBA,GAAI0J,OAAO1J,M,0BCHnC2J,GAAcC,MAAaC,MAAM,CACrCzL,MAAOwL,MAAaxL,MAAM,iBAAiB0L,SAAS,YACpDzL,SAAUuL,MACPjH,IAAI,EAAG,gCACPmH,SAAS,cAUDC,GAAgC,SAAC,GAAkB,IAAhB/I,EAAe,EAAfA,SAC9C,OACE,kBAAC,IAAD,CACEC,cAAe,CAAE7C,MAAO,GAAIC,SAAU,IACtC2L,iBAAkBL,GAClB3I,SAAQ,iHAAE,SAACM,EAAQC,GACjB,GAAIP,EACF,OAAOA,EAASM,EAAqBC,QAKxC,gBACC0I,EADD,EACCA,OACA3I,EAFD,EAECA,OACA4I,EAHD,EAGCA,QACA1I,EAJD,EAICA,aACAC,EALD,EAKCA,WACAC,EAND,EAMCA,aACAC,EAPD,EAOCA,aACAC,EARD,EAQCA,OACAC,EATD,EASCA,UATD,OAYC,kBAACE,EAAA,EAAD,CACEC,YAAU,EACVhB,SAAU,SAACiB,GAAD,OAAOP,EAAaO,IAC9BC,SAAU,kBAAML,EAAU,QAEvBD,GAAU,kBAACO,EAAA,EAAD,CAAOC,QAAQ,UAAUR,GACtC,kBAACG,EAAA,EAAKM,MAAN,KACE,kBAACN,EAAA,EAAKO,MAAN,sBACA,kBAACP,EAAA,EAAKQ,QAAN,CACEC,KAAK,QACLtG,KAAK,QACLiO,YAAY,cACZ1H,OAAQhB,EACRiB,MAAOpB,EAAOlD,MACd8D,SAAUV,EACV4I,QAASF,EAAQ9L,QAAU6L,EAAO7L,MAClCiM,UAAWH,EAAQ9L,SAAW6L,EAAO7L,QAEvC,kBAAC2D,EAAA,EAAKQ,QAAQ+H,SAAd,CAAuB9H,KAAK,WACzByH,EAAO7L,QAIZ,kBAAC2D,EAAA,EAAKM,MAAN,KACE,kBAACN,EAAA,EAAKO,MAAN,iBACA,kBAACP,EAAA,EAAKQ,QAAN,CACEC,KAAK,WACLtG,KAAK,WACLiO,YAAY,WACZjI,SAAUV,EACViB,OAAQhB,EACRiB,MAAOpB,EAAOjD,SACd+L,QAASF,EAAQ7L,WAAa4L,EAAO5L,SACrCgM,UAAWH,EAAQ7L,YAAc4L,EAAO5L,WAE1C,kBAAC0D,EAAA,EAAKQ,QAAQ+H,SAAd,CAAuB9H,KAAK,WACzByH,EAAO5L,WAGZ,kBAAC6E,EAAA,EAAD,CAAQd,QAAQ,UAAUI,KAAK,SAASa,SAAU1B,GAAlD,cC7EJ4I,GAAqBX,MAAaC,MAAM,CAC5CrL,SAAUoL,MAAaE,SAAS,YAChC1L,MAAOwL,MAAaxL,MAAM,iBAAiB0L,SAAS,YACpDzL,SAAUuL,MACPjH,IAAI,EAAG,gCACPmH,SAAS,YACZrL,gBAAiBmL,MACdY,OAAO,CAACZ,IAAQ,aAAc,8BAC9BE,SAAS,cAiBDW,GAA8C,SAAC,GAAkB,IAAhBzJ,EAAe,EAAfA,SAC5D,OACE,kBAAC,IAAD,CACEC,cAAe,CACbzC,SAAU,GACVJ,MAAO,GACPC,SAAU,GACVI,gBAAiB,IAEnBuL,iBAAkBO,GAClBvJ,SAAQ,iHAAE,SAACM,EAAQC,GACjB,GAAIP,EACF,OAAOA,EAASM,EAAgCC,QAKnD,gBACC0I,EADD,EACCA,OACA3I,EAFD,EAECA,OACA4I,EAHD,EAGCA,QACA1I,EAJD,EAICA,aACAC,EALD,EAKCA,WACAC,EAND,EAMCA,aACAC,EAPD,EAOCA,aACAC,EARD,EAQCA,OACAC,EATD,EASCA,UATD,OAYC,kBAACE,EAAA,EAAD,CACEC,YAAU,EACVhB,SAAU,SAACiB,GAAD,OAAOP,EAAaO,IAC9BC,SAAU,kBAAML,EAAU,QAEvBD,GAAU,kBAACO,EAAA,EAAD,CAAOC,QAAQ,UAAUR,GAEtC,kBAACG,EAAA,EAAKM,MAAN,KACE,kBAACN,EAAA,EAAKO,MAAN,kBACA,kBAACP,EAAA,EAAKQ,QAAN,CACEC,KAAK,OACLtG,KAAK,WACLiO,YAAY,kBACZ1H,OAAQhB,EACRiB,MAAOpB,EAAO9C,SACd0D,SAAUV,EACV4I,QAASF,EAAQ1L,WAAayL,EAAOzL,SACrC6L,UAAWH,EAAQ1L,YAAcyL,EAAOzL,WAE1C,kBAACuD,EAAA,EAAKQ,QAAQ+H,SAAd,CAAuB9H,KAAK,WACzByH,EAAOzL,WAIZ,kBAACuD,EAAA,EAAKM,MAAN,KACE,kBAACN,EAAA,EAAKO,MAAN,sBACA,kBAACP,EAAA,EAAKQ,QAAN,CACEC,KAAK,QACLtG,KAAK,QACLiO,YAAY,cACZ1H,OAAQhB,EACRiB,MAAOpB,EAAOlD,MACd8D,SAAUV,EACV4I,QAASF,EAAQ9L,QAAU6L,EAAO7L,MAClCiM,UAAWH,EAAQ9L,SAAW6L,EAAO7L,QAEvC,kBAAC2D,EAAA,EAAKQ,QAAQ+H,SAAd,CAAuB9H,KAAK,WACzByH,EAAO7L,QAIZ,kBAAC2D,EAAA,EAAKM,MAAN,KACE,kBAACN,EAAA,EAAKO,MAAN,iBACA,kBAACP,EAAA,EAAKQ,QAAN,CACEC,KAAK,WACLtG,KAAK,WACLiO,YAAY,WACZjI,SAAUV,EACViB,OAAQhB,EACRiB,MAAOpB,EAAOjD,SACd+L,QAASF,EAAQ7L,WAAa4L,EAAO5L,SACrCgM,UAAWH,EAAQ7L,YAAc4L,EAAO5L,WAE1C,kBAAC0D,EAAA,EAAKQ,QAAQ+H,SAAd,CAAuB9H,KAAK,WACzByH,EAAO5L,WAIZ,kBAAC0D,EAAA,EAAKM,MAAN,KACE,kBAACN,EAAA,EAAKO,MAAN,yBACA,kBAACP,EAAA,EAAKQ,QAAN,CACEC,KAAK,WACLtG,KAAK,kBACLiO,YAAY,WACZjI,SAAUV,EACViB,OAAQhB,EACRiB,MAAOpB,EAAO7C,gBACd2L,QAASF,EAAQzL,kBAAoBwL,EAAOxL,gBAC5C4L,UAAWH,EAAQzL,mBAAqBwL,EAAOxL,kBAEjD,kBAACsD,EAAA,EAAKQ,QAAQ+H,SAAd,CAAuB9H,KAAK,WACzByH,EAAOxL,kBAIZ,kBAACyE,EAAA,EAAD,CAAQd,QAAQ,UAAUI,KAAK,SAASa,SAAU1B,GAAlD,iB,SC3EK+I,GApDyB,WACtC,IAAMtN,EAAWmD,cAEXoK,EAAUC,IAAM7G,aACpB,SAACzC,EAAmBC,GAClB,OAAOnE,EAASW,aAAMuD,IAAS6C,OAAM,SAACC,GACb,MAAnBA,EAAIxG,WACN2D,EAAcM,UAAU,+BAExBN,EAAcM,UAAU,8BAI9B,CAACzE,IAGGyN,EAAWD,IAAM7G,aACrB,SACEzC,EACAC,GAEA,OAAOnE,EACLkB,aAAS,CACPE,SAAU8C,EAAO9C,SACjBJ,MAAOkD,EAAOlD,MACdC,SAAUiD,EAAOjD,YAEnB8F,OAAM,SAACC,GACgB,MAAnBA,EAAIxG,WACN2D,EAAcM,UACZ,gDAGFN,EAAcM,UAAU,8BAI9B,CAACzE,IAGH,OACE,kBAAC0N,EAAA,EAAD,CAAMC,YAAY,GAChB,kBAACC,EAAA,EAAD,CAAKC,SAAS,OAAO3H,MAAM,SACzB,kBAAC,GAAD,CAAWtC,SAAU2J,KAEvB,kBAACK,EAAA,EAAD,CAAKC,SAAS,UAAU3H,MAAM,YAC5B,kBAAC,GAAD,CAAkBtC,SAAU6J,O,2BCoCrBK,UArEC,WACd,IAAM9N,EAAWmD,cAEX4H,EAA2B1H,aAAY,SAAChE,GAC5C,OAAIA,EAAM0L,YAAY/L,OACbsE,YAAYjE,EAAM0L,YAAY/L,OAAQX,IAAYgB,EAAMmE,UAE1D,QAEDuK,EAAuB1K,aAC7B,SAAChE,GAAD,OAAsBA,EAAM2O,aADtBD,mBAUR,OANAtK,qBAAU,WACRzD,EAASD,gBACTC,EAASiO,gBACTjO,EAASkO,kBACR,CAAClO,IAGF,kBAAC,IAAD,KACG+K,EACC,oCACE,oCAAUA,EAAY3J,UACtB,kBAAC0E,EAAA,EAAD,CAAQd,QAAQ,UAAUe,QAAS,kBAAM/F,EAASuB,kBAAlD,WAKF,kBAACuE,EAAA,EAAD,CAAQd,QAAQ,UAAUe,QAAS,kBAAM/F,EAASmO,kBAAlD,oBAKF,kBAAC/G,EAAA,EAAD,CACEC,KAAM0G,EACNzG,OAAQ,kBAAMtH,EAASoO,iBACvB5G,WAAW,GAEX,kBAACJ,EAAA,EAAMK,OAAP,CAAcC,aAAW,GACvB,kBAACN,EAAA,EAAMO,MAAP,eAGF,kBAACP,EAAA,EAAMQ,KAAP,KACE,kBAAC,GAAD,QAGJ,6BACE,6BACE,4BACE,4BACE,kBAAC,IAAD,CAAMjF,GAAG,KAAT,WAKN,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAO0L,KAAK,aACV,kBAAC,EAAD,OAEF,kBAAC,IAAD,CAAOA,KAAK,KACV,kBAAC,EAAD,Y,4FCxEQC,QACW,cAA7BC,OAAOC,SAASC,UAEe,UAA7BF,OAAOC,SAASC,UAEhBF,OAAOC,SAASC,SAASC,MACvB,2D,qGCkBAC,EAA2B,SAC/BtP,EACAE,GAIAqP,OAAOC,OAAOxP,EAAMyP,MAAOvP,EAAOC,QAAQgE,SAASsL,OACnDF,OAAOC,OAAOxP,EAAM8C,MAAO5C,EAAOC,QAAQgE,SAASrB,QA+DtC4M,EA5DOlQ,YAAY,CAChCC,KAAM,WACNC,aAjBkC,CAClC+P,MAAO,GACP3M,MAAO,IAgBPhD,SAAU,GACV6P,eAAa,mBACV1P,IAAsB8F,MAAO,SAC5B/F,EACAE,GAIIA,EAAOC,SACTmP,EAAyBtP,EAAO,CAC9B+F,KAAM7F,EAAO6F,KACb5F,QAASD,EAAOC,aAVX,cAcVG,IAAayF,KAAOuJ,GAdV,cAeV/O,IAAgBwF,KAAOuJ,GAfb,cAgBVM,IAAuB7J,KAAOuJ,GAhBpB,cAiBVO,IAAqB9J,KAAOuJ,GAjBlB,cAkBVQ,IAAmB/J,KAAOuJ,GAlBhB,cAmBVS,IAAyBhK,KAAOuJ,GAnBtB,cAoBVU,IAAyBjK,KAAOuJ,GApBtB,cAqBVW,IAAgBlK,MAAO,SACtB/F,EACAE,GAEAF,EAAM8C,MAAM5C,EAAOC,QAAQ+P,QAAQlE,KACW,UAA5ChM,EAAM8C,MAAM5C,EAAOC,QAAQ+P,QAAQlE,KAAmB,QAAU,QAClEhM,EAAM8C,MAAM5C,EAAOC,QAAQ+P,QAAQ3N,MAAQ,UACzCvC,EAAM8C,MAAM5C,EAAOC,QAAQ+P,QAAQ3N,MADM,YAEvCrC,EAAOC,QAAQuC,MAAOyN,UA7BjB,cA+BVC,IAAgBrK,KAAOuJ,GA/Bb,cAgCVe,IAAgBtK,MAAO,SAAC/F,GACPuP,OAAOe,KAAKtQ,EAAM8C,OAE1BL,SAAQ,SAACyN,GACf,IAAM/N,EAAOnC,EAAM8C,MAAMoN,GAEzB,GAAoB,YAAhB/N,EAAKgD,OAAsB,CAC7B,IAAMoL,EAA6B,UAAdpO,EAAK6J,KAAmB,QAAU,QAEvD7J,EAAKoO,IAAiB,IAClBpO,EAAKoO,GAAgB,IACvBpO,EAAKoO,GAAgB,GAGI,IAAvBpO,EAAKoO,KACPpO,EAAKgD,OAAS,YACdhD,EAAKuG,OAAuB,UAAdvG,EAAK6J,KAAmB,QAAU,gBAhD7C,KAwDf,QClFewE,EAbKC,YAAgB,CAClC9B,UAAW+B,IACX5I,iBAAkB6I,IAElBjF,YAAakF,IACb1M,aAAc2M,IACd1M,SAAU2M,EAEVC,WAAYC,MCICC,MAfDC,YAAe,CAC3BC,QAASX,KCCI,WACb,IAAM/B,EAAM2C,EAAQ,KAAaC,QAEjCC,IAASC,OACP,kBAAC,IAAMC,WAAP,KACE,kBAAC,IAAD,CAAUP,MAAOA,GACf,kBAACxC,EAAD,QAGJgD,SAASC,eAAe,SAI5BH,GJiHM,kBAAmBI,WACrBA,UAAUC,cAAcC,MACrBrK,MAAK,SAACsK,GACLA,EAAaC,gBAEdrK,OAAM,SAAC7H,GACNmS,QAAQnS,MAAMA,EAAMoS,a,gCK9I5B,IAEMjT,EAAa,IAFnB,KAEuBH,EAAOC,QAAO,SAEtBE,O,mBCHfN,EAAOC,QAAU,CAAC,iBAAmB,0CAA0C,aAAe,sCAAsC,mBAAqB,4CAA4C,YAAc,qCAAqC,YAAc,qCAAqC,aAAe,wC,gCCD1T,sGAkBMuT,EAAiB1S,YAAY,CACjCC,KAAM,YACNC,aAJmC,GAKnCI,SAAU,CACRqS,mBADQ,aAERrC,mBAFQ,SAGNsC,EACAC,KAEFC,iBANQ,SAMSF,EAAQC,MAE3B1C,cAAe,K,EAObuC,EAAezR,QAHjB0R,E,EAAAA,mBACArC,E,EAAAA,mBACAwC,E,EAAAA,iBAKW/K,GAFE2K,EAAf,QAE2B,SAAC3Q,GAAD,OAAoD,SAC7EZ,GAIA,OAFAA,EAASwR,KAEF,IAAIvR,SAAQ,SAACC,EAASC,GAC3B5B,IAAS6B,OAAOe,KAAhB,uBAEEP,GACA,SAACN,EAAeC,GACd,GAAuB,MAAnBA,EAAIC,WAAoB,CAC1B,IAAMoR,EAAiBlR,YAAUJ,EAAcrC,KAE/C+B,EAASmP,EAAmByC,IAC5B1R,EAAQI,QAERN,EAAS2R,EAAiBrR,IAC1BH,EAAOI,a,iLCzCXsR,EAAwBhT,YAAY,CACxCC,KAAM,mBACNC,aAJ0C,GAK1CI,SAAU,CACRiQ,yBADQ,SAENqC,EACAC,KAEFrC,yBALQ,SAMNoC,EACAC,MAGJ1C,cAAe,K,EAMb6C,EAAsB/R,QAFxBsP,E,EAAAA,yBACAC,E,EAAAA,yBAKWpB,GAFE4D,EAAf,QAE0B,kBAAsB,SAAC7R,GAC/CzB,IAAS6B,OAAO0R,GAAG,QAAQ,SAACC,GAC1B,GAA8B,YAA1BA,EAAiBC,KAAoB,CACvC,IAAMxQ,EAAI,eACLuQ,EAAiBE,SADZ,GAELF,EAAiBnR,MAGhBgR,EAAiBlR,YAAUc,EAAMvD,KAEvC+B,EAASoP,EAAyBwC,SAC7B,GAA8B,YAA1BG,EAAiBC,KAAoB,CAC9C,IAAMJ,EAAiBlR,YAAUqR,EAAiBnR,KAAM3C,KAExD+B,EAASqP,EAAyBuC,Y,gKCxBlCM,EAAoBrT,YAAY,CACpCC,KAAM,eACNC,aARsC,CACtCqE,MAAO,GACPnE,WAAW,EACXC,MAAO,MAMPC,SAAU,CACRgT,uBADQ,SACe9S,GACrBA,EAAMJ,WAAY,EAClBI,EAAMH,MAAQ,MAEhB+P,uBALQ,SAMN5P,EACAE,GAEAF,EAAM+D,MAAQ7D,EAAOC,QAAQC,OAC7BJ,EAAMJ,WAAY,EAClBI,EAAMH,MAAQ,MAEhBkT,qBAbQ,SAaa/S,EAAOE,GAC1BF,EAAMJ,WAAY,EAClBI,EAAMH,MAAQK,EAAOC,UAGzBwP,eAAa,mBACVG,IAAmB/J,MAAO,SACzB/F,EACAE,GAEKF,EAAM+D,MAAMiP,SAAS9S,EAAOC,QAAQC,SACvCJ,EAAM+D,MAAMkP,QAAQ/S,EAAOC,QAAQC,WAN5B,cASV4P,IAAyBjK,MAAO,SAC/B/F,EACAE,GAEKF,EAAM+D,MAAMiP,SAAS9S,EAAOC,QAAQC,SACvCJ,EAAM+D,MAAMkP,QAAQ/S,EAAOC,QAAQC,WAd5B,cAiBV2P,IAAyBhK,MAAO,SAC/B/F,EACAE,GAEKF,EAAM+D,MAAMiP,SAAS9S,EAAOC,QAAQC,SACvCJ,EAAM+D,MAAMkP,QAAQ/S,EAAOC,QAAQC,WAtB5B,K,EAgCXyS,EAAkBpS,QAHpBqS,E,EAAAA,uBACAlD,E,EAAAA,uBACAmD,E,EAAAA,qBAGaF,MAAf,QAEO,IAAMxO,EAAoB,kBAAiC,SAChE1D,GAIA,OAFAA,EAASmS,KAEF,IAAIlS,SAAQ,SAACC,EAASC,GAC3B5B,IAAS6B,OAAOC,IAAI,wBAAwB,SAACC,EAAeC,GAC1D,GAAuB,MAAnBA,EAAIC,WAAoB,CAC1B,IAAM+R,EAAkB7R,YAAUJ,EAAgB,CAACrC,MACnD+B,EAASiP,EAAuBsD,IAEhCrS,EAAQI,QAERN,EAASoS,EAAqB9R,IAC9BH,EAAOI,Y,gCCpGf,sGAsBMiS,EAAkB3T,YAAY,CAClCC,KAAM,aACNC,aAJoC,GAKpCI,SAAU,CACRsT,qBADQ,SACapT,EAAOE,GAC1BF,EAAME,EAAOC,SAAW,CACtBP,WAAW,EACXC,MAAO,OAGXgQ,qBAPQ,SAOa7P,EAAOE,GAC1BF,EAAME,EAAOC,QAAQC,QAAU,CAC7BR,WAAW,EACXC,MAAO,OAGXwT,mBAbQ,SAaWrT,EAAOE,GACxBF,EAAME,EAAOC,QAAQmT,QAAU,CAC7B1T,WAAW,EACXC,MAAOK,EAAOC,QAAQN,SAI5B8P,cAAe,K,EAObwD,EAAgB1S,QAHlB2S,E,EAAAA,qBACAvD,E,EAAAA,qBACAwD,E,EAAAA,mBAGaF,MAAf,QAEO,IAAMtG,EAAY,SAACtJ,GAAD,OAAyC,SAChE5C,GAIA,OAFAA,EAASyS,EAAqB7P,IAEvB,IAAI3C,SAAQ,SAACC,EAASC,GAC3B5B,IAAS6B,OAAOC,IAAhB,gBAA6BuC,IAAM,SAACtC,EAAeC,GACjD,GAAuB,MAAnBA,EAAIC,WAAoB,CAC1B,IAAMoR,EAAiBlR,YAAUJ,EAAcrC,KAC/C+B,EAASkP,EAAqB0C,IAC9B1R,EAAQI,QAERN,EACE0S,EAAmB,CACjBC,OAAQ/P,EACR1D,MAAOoB,KAGXH,EAAOI,Y,iICzDTqS,EAAiB/T,YAAY,CACjCC,KAAM,YACNC,aANmC,CACnCgP,oBAAoB,GAMpB5O,SAAU,CACRgP,cADQ,SACM9O,GACZA,EAAM0O,oBAAqB,GAE7BK,cAJQ,SAIM/O,GACZA,EAAM0O,oBAAqB,IAG/BiB,eAAa,mBACVrP,IAAayF,MAAO,SAAC/F,GACpBA,EAAM0O,oBAAqB,KAFlB,cAIVnO,IAAgBwF,MAAO,SAAC/F,GACvBA,EAAM0O,oBAAqB,KALlB,K,EAUiC6E,EAAe9S,QAAhDqO,E,EAAAA,cAAeC,E,EAAAA,cAEfwE,MAAf,S,+HC1BMC,EAAwBhU,YAAY,CACxCC,KAAM,mBACNC,aAN0C,CAC1CmI,2BAA2B,GAM3B/H,SAAU,CACR0I,qBADQ,SACaxI,GACnBA,EAAM6H,2BAA4B,GAEpCK,qBAJQ,SAIalI,GACnBA,EAAM6H,2BAA4B,IAGtC8H,cAAc,eACXG,IAAmB/J,MAAO,SAAC/F,GAC1BA,EAAM6H,2BAA4B,O,EAQpC2L,EAAsB/S,QAFxB+H,E,EAAAA,qBACAN,E,EAAAA,qBAGasL,MAAf,S,gCCrCA,wIAiBMC,EAAYjU,YAAY,CAC5BC,KAAM,OACNC,aAJ8B,GAK9BI,SAAU,CACRmQ,gBADQ,SACQmC,EAAQC,KACxBjC,gBAFQ,SAEQgC,EAAQC,KACxBqB,cAHQ,SAGMtB,EAAQC,MAExB1C,cAAe,K,EAOb8D,EAAUhT,QAHZwP,E,EAAAA,gBACAG,E,EAAAA,gBACAsD,E,EAAAA,cAUW5G,GAPE2G,EAAf,QAOwB,SACtBvD,EACAxN,GAFsB,OAGM,SAAC/B,GAQ7B,OAPAA,EACEsP,EAAgB,CACdC,SACAxN,UAIG,IAAI9B,SAAQ,SAACC,EAASC,GAC3B5B,IAAS6B,OAAOe,KAAhB,6BACwBoO,EADxB,iBACuCxN,GACrC,IACA,SAACzB,EAAeC,GACd,GAAuB,MAAnBA,EAAIC,WAAoB,CAC1B,IAAMoR,EAAiBlR,YAAUJ,EAAcrC,KAE/C+B,EAASyP,EAAgBmC,IACzB1R,EAAQI,QAERN,EAAS+S,EAAczS,IACvBH,EAAOI,a,gCChEjB,+EAUMyS,EAAiBnU,YAAY,CACjCC,KAAM,YACNC,aAJmC,GAKnCI,SAAU,CACRuQ,gBADQ,cAGVV,cAAe,KAGFU,EAAoBsD,EAAelT,QAAnC4P,gBAIFxB,GAFE8E,EAAf,QAE8B,kBAAsB,SAAChT,GACnDiT,aAAY,WACVjT,EAAS0P,OACR,U","file":"static/js/main.f3d0943f.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"grid\":\"GamePreviewsList_grid__3uPGL\"};","import { schema } from \"normalizr\";\nimport userSchema from \"./userSchema\";\n\nconst gameSchema = new schema.Entity(\"games\", {\n  white: userSchema,\n  black: userSchema,\n});\n\nexport default gameSchema;\n","import socketIOClient from \"socket.io-client\";\nimport sailsIOClient from \"sails.io.js\";\n\nconst ioClient = sailsIOClient(socketIOClient);\n\nioClient.sails.url = \"http://localhost:1337\";\n\nexport default ioClient;\n","/* eslint-disable no-param-reassign */\n/* eslint-disable import/no-cycle */\n\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { normalize } from \"normalizr\";\nimport { JWR } from \"sails.io.js\";\nimport { AppThunk } from \"../../app/store\";\nimport ioClient from \"../../services/ioClient\";\nimport User from \"../../interfaces/User\";\nimport LoginData from \"../../interfaces/LoginData\";\nimport SignUpData from \"../../interfaces/SignUpData\";\nimport userSchema from \"../../normalizr/schemas/userSchema\";\nimport NormalizedData from \"../../normalizr/interfaces/NormalizedData\";\n\ninterface CurrentUserState {\n  userId: number | null;\n  isLoading: boolean;\n  error: string | null;\n}\n\nconst initialState: CurrentUserState = {\n  userId: null,\n  isLoading: true,\n  error: null,\n};\n\nconst currentUserSlice = createSlice({\n  name: \"currentUser\",\n  initialState,\n  reducers: {\n    getCurrentUserRequest(state) {\n      state.isLoading = true;\n      state.error = null;\n    },\n    getCurrentUserSuccess(\n      state,\n      action: PayloadAction<NormalizedData<number> | null>\n    ) {\n      state.userId = action.payload ? action.payload.result : null;\n      state.isLoading = false;\n      state.error = null;\n    },\n    getCurrentUserError(state, action: PayloadAction<string>) {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n    loginSuccess(state, action: PayloadAction<NormalizedData<number>>) {\n      state.userId = action.payload.result;\n    },\n    registerSuccess(state, action: PayloadAction<NormalizedData<number>>) {\n      state.userId = action.payload.result;\n    },\n    logoutSuccess(state) {\n      state.userId = null;\n    },\n  },\n});\n\nexport const {\n  getCurrentUserRequest,\n  getCurrentUserSuccess,\n  getCurrentUserError,\n  loginSuccess,\n  registerSuccess,\n  logoutSuccess,\n} = currentUserSlice.actions;\n\nexport default currentUserSlice.reducer;\n\nexport const fetchCurrentUser = (): AppThunk<Promise<User | null>> => (\n  dispatch\n) => {\n  dispatch(getCurrentUserRequest());\n\n  return new Promise((resolve, reject) => {\n    ioClient.socket.get(\"/api/v1/account/me\", (body: unknown, jwr: JWR) => {\n      if (jwr.statusCode === 200) {\n        const normalizedUser = normalize(body as User, userSchema);\n\n        dispatch(getCurrentUserSuccess(normalizedUser));\n        resolve(body as User);\n      } else if (jwr.statusCode === 401) {\n        dispatch(getCurrentUserSuccess(null));\n        resolve(null);\n      } else {\n        dispatch(getCurrentUserError(body as string));\n        reject(jwr);\n      }\n    });\n  });\n};\n\nexport const login = (data: LoginData): AppThunk<Promise<User>> => (\n  dispatch\n) => {\n  return new Promise((resolve, reject) => {\n    ioClient.socket.put(\n      \"/api/v1/entrance/login\",\n      {\n        rememberMe: true,\n        emailAddress: data.email,\n        password: data.password,\n      },\n      (body: unknown, jwr: JWR) => {\n        if (jwr.statusCode === 200) {\n          const normalizedUser = normalize(body as User, userSchema);\n\n          dispatch(loginSuccess(normalizedUser));\n          resolve(body as User);\n        } else {\n          reject(jwr);\n        }\n      }\n    );\n  });\n};\n\nexport const register = (data: SignUpData): AppThunk<Promise<User>> => (\n  dispatch\n) => {\n  return new Promise((resolve, reject) => {\n    ioClient.socket.post(\n      \"/api/v1/entrance/signup\",\n      {\n        fullName: data.fullName,\n        emailAddress: data.email,\n        password: data.password,\n        confirmPassword: data.password,\n        agreed: true,\n      },\n      (body: unknown, jwr: JWR) => {\n        if (jwr.statusCode === 200) {\n          const normalizedUser = normalize(body as User, userSchema);\n\n          dispatch(registerSuccess(normalizedUser));\n          resolve(body as User);\n        } else {\n          reject(jwr);\n        }\n      }\n    );\n  });\n};\n\nexport const logout = (): AppThunk<Promise<void>> => (dispatch) => {\n  return new Promise((resolve, reject) => {\n    ioClient.socket.post(\n      \"/api/v1/account/logout\",\n      {},\n      (body: unknown, jwr: JWR) => {\n        if (jwr.statusCode === 200) {\n          dispatch(logoutSuccess());\n          resolve();\n        } else {\n          reject(jwr);\n        }\n      }\n    );\n  });\n};\n","import { Chess, ChessInstance } from \"chess.js\";\nimport Game from \"../interfaces/Game\";\n\nconst startPositionFen =\n  \"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1\";\n\nexport default (game: Game): ChessInstance => {\n  let { initialFen } = game;\n  if (initialFen === \"startpos\") {\n    initialFen = startPositionFen;\n  }\n\n  const chess = new Chess(initialFen);\n\n  if (game.moves) {\n    game.moves.split(\" \").forEach((move) => {\n      const result = chess.move(move, {\n        sloppy: true,\n      });\n\n      if (!result) {\n        throw Error(`incorrect move: ${move}`);\n      }\n    });\n  }\n\n  return chess;\n};\n","import React, { FC } from \"react\";\nimport { Board } from \"ii-react-chessboard\";\nimport { Link } from \"react-router-dom\";\nimport Game from \"../../interfaces/Game\";\nimport css from \"./GamePreviewsList.module.scss\";\nimport makeChessInstance from \"../../utils/makeChessInstance\";\n\nexport interface GamePreviewsListProps {\n  games?: Game[];\n}\n\nexport const GamePreviewsList: FC<GamePreviewsListProps> = ({ games = [] }) => {\n  return (\n    <div className={css.grid}>\n      {games.map((item) => {\n        const fen: string = makeChessInstance(item).fen();\n\n        return (\n          <Link to={`/game/${item.id}`} key={item.id}>\n            <div className={css.cell}>\n              <Board position={fen} viewOnly={false} width={240} />\n            </div>\n          </Link>\n        );\n      })}\n    </div>\n  );\n};\n","import React, { FC, useEffect } from \"react\";\nimport { denormalize } from \"normalizr\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { GamePreviewsList } from \"./GamePreviewsList\";\nimport { RootState } from \"../../app/rootReducer\";\nimport { fetchOngoingGames } from \"./ongoingGamesSlice\";\nimport gameSchema from \"../../normalizr/schemas/gameSchema\";\n\nconst OngoingGamesContainer: FC<unknown> = () => {\n  const dispatch = useDispatch();\n\n  const items = useSelector((state: RootState) =>\n    denormalize(state.ongoingGames.items, [gameSchema], state.entities)\n  );\n\n  useEffect(() => {\n    dispatch(fetchOngoingGames());\n  }, [dispatch]);\n\n  return <GamePreviewsList games={items} />;\n};\n\nexport default OngoingGamesContainer;\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport { Formik, FormikHelpers } from \"formik\";\nimport React, { FC, FormEvent } from \"react\";\nimport cx from \"classnames\";\nimport { Alert, Button, ButtonGroup, Form, Row } from \"react-bootstrap\";\nimport { ChallengeAiData } from \"../../interfaces/ChallengeAiData\";\nimport css from \"./ChallengeAiForm.module.scss\";\n\nexport interface ChallengeAiFormProps {\n  onSubmit?(\n    values: ChallengeAiData,\n    formikHelpers: FormikHelpers<ChallengeAiData>\n  ): void | Promise<any>;\n}\n\nexport const ChallengeAiForm: FC<ChallengeAiFormProps> = ({ onSubmit }) => {\n  return (\n    <Formik\n      initialValues={{\n        level: 3,\n        color: \"\",\n        clockLimit: 300,\n        clockIncrement: 3,\n      }}\n      onSubmit={(values, formikHelpers): Promise<any> | void => {\n        if (onSubmit) {\n          return onSubmit(\n            values as ChallengeAiData,\n            formikHelpers as FormikHelpers<ChallengeAiData>\n          );\n        }\n        return undefined;\n      }}\n    >\n      {({\n        values,\n        handleChange,\n        handleBlur,\n        handleSubmit,\n        isSubmitting,\n        status,\n        setStatus,\n        setFieldValue,\n        /* and other goodies */\n      }) => (\n        <Form\n          noValidate\n          onSubmit={(e) => handleSubmit(e as FormEvent<HTMLFormElement>)}\n          onChange={() => setStatus(\"\")}\n        >\n          {!!status && <Alert variant=\"danger\">{status}</Alert>}\n          <fieldset>\n            <Form.Group>\n              <Form.Label>\n                Minutes per side: {values.clockLimit / 60}\n              </Form.Label>\n              <Form.Control\n                type=\"range\"\n                name=\"clockLimit\"\n                onBlur={handleBlur}\n                value={values.clockLimit}\n                onChange={handleChange}\n                min=\"60\"\n                max=\"1800\"\n                step=\"60\"\n              />\n            </Form.Group>\n\n            <Form.Group>\n              <Form.Label>\n                Increment in seconds: {values.clockIncrement}\n              </Form.Label>\n              <Form.Control\n                type=\"range\"\n                name=\"clockIncrement\"\n                onBlur={handleBlur}\n                value={values.clockIncrement}\n                onChange={handleChange}\n                min=\"0\"\n                max=\"60\"\n              />\n            </Form.Group>\n          </fieldset>\n\n          <div className=\"text-center\">Level</div>\n\n          <Row>\n            <ButtonGroup className={cx(\"mx-auto\", css.levelButtonGroup)}>\n              {[1, 2, 3, 4].map((level) => (\n                <Button\n                  key={level}\n                  type=\"button\"\n                  variant={level === values.level ? \"dark\" : \"light\"}\n                  onClick={() => setFieldValue(\"level\", level)}\n                >\n                  {level}\n                </Button>\n              ))}\n            </ButtonGroup>\n          </Row>\n\n          <div className=\"text-center\">A.I. Level: {values.level}</div>\n\n          <div className={css.colorSubmits}>\n            <button\n              disabled={isSubmitting}\n              type=\"submit\"\n              title=\"Black\"\n              className={cx(css.colorSubmitsButton, css.blackButton)}\n              onClick={() => setFieldValue(\"color\", \"black\")}\n            >\n              <i />\n            </button>\n            <button\n              disabled={isSubmitting}\n              type=\"submit\"\n              title=\"Random side\"\n              className={cx(css.colorSubmitsButton, css.randomButton)}\n              onClick={() => setFieldValue(\"color\", \"random\")}\n            >\n              <i />\n            </button>\n            <button\n              disabled={isSubmitting}\n              type=\"submit\"\n              title=\"White\"\n              className={cx(css.colorSubmitsButton, css.whiteButton)}\n              onClick={() => setFieldValue(\"color\", \"white\")}\n            >\n              <i />\n            </button>\n          </div>\n        </Form>\n      )}\n    </Formik>\n  );\n};\n","import React, { FC, useCallback } from \"react\";\nimport { FormikHelpers } from \"formik\";\nimport { useHistory } from \"react-router-dom\";\nimport { useDispatch } from \"react-redux\";\nimport { ChallengeAiForm } from \"./ChallengeAiForm\";\nimport { AppDispatch } from \"../../app/store\";\nimport { challengeAi } from \"../challenge/challengeSlice\";\nimport { ChallengeAiData } from \"../../interfaces/ChallengeAiData\";\nimport Game from \"../../interfaces/Game\";\n\nconst ChallengeAiFormContainer: FC<unknown> = () => {\n  const dispatch = useDispatch<AppDispatch>();\n\n  const history = useHistory();\n\n  const challengeAiAndOpenGamePage = useCallback(\n    (\n      values: ChallengeAiData,\n      formikHelpers: FormikHelpers<ChallengeAiData>\n    ) => {\n      return dispatch(challengeAi(values))\n        .then((game: Game) => {\n          history.push(`/game/${game.id}`);\n        })\n        .catch((err) => {\n          if (err.statusCode === 401) {\n            formikHelpers.setStatus(\"You must log in to play with computer\");\n          } else {\n            formikHelpers.setStatus(\"Internal server error\");\n          }\n        });\n    },\n    [dispatch, history]\n  );\n\n  return <ChallengeAiForm onSubmit={challengeAiAndOpenGamePage} />;\n};\n\nexport default ChallengeAiFormContainer;\n","import React, { FC } from \"react\";\nimport { Button, Modal } from \"react-bootstrap\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport OngoingGamesContainer from \"../features/ongoing-games/OngoingGamesContainer\";\nimport ChallengeAiFormContainer from \"../features/challenge-ai-modal/ChallengeAiFormContainer\";\n\nimport { RootState } from \"../app/rootReducer\";\nimport {\n  hideChallengeAiModal,\n  showChallengeAiModal,\n} from \"../features/challenge-ai-modal/challengeAiModalSlice\";\nimport { AppDispatch } from \"../app/store\";\n\nconst HomePage: FC<unknown> = () => {\n  const dispatch = useDispatch<AppDispatch>();\n\n  const { isChallengeAiModalVisible } = useSelector(\n    (state: RootState) => state.challengeAiModal\n  );\n\n  return (\n    <>\n      <Modal\n        show={isChallengeAiModalVisible}\n        onHide={() => dispatch(hideChallengeAiModal())}\n        animation={false}\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>Play with the computer</Modal.Title>\n        </Modal.Header>\n\n        <Modal.Body>\n          <ChallengeAiFormContainer />\n        </Modal.Body>\n      </Modal>\n      <Button\n        variant=\"primary\"\n        onClick={() => dispatch(showChallengeAiModal())}\n      >\n        Play with the computer\n      </Button>\n      <OngoingGamesContainer />\n    </>\n  );\n};\n\nexport default HomePage;\n","import React, { FC } from \"react\";\nimport Game from \"../../interfaces/Game\";\nimport getGameStatusText from \"../../utils/getGameStatusText\";\n\nexport interface GameMetaProps {\n  game?: Game;\n}\n\nexport const GameMeta: FC<GameMetaProps> = ({ game }) => {\n  if (!game) {\n    return null;\n  }\n\n  return (\n    <>\n      <div>{getGameStatusText(game)}</div>\n      <div>\n        {game.clockLimit / 60} + {game.clockIncrement}\n      </div>\n      <div data-testid=\"white-user\">\n        White: {game.white ? game.white.fullName : `AI level ${game.aiLevel}`}\n      </div>\n      <div data-testid=\"black-user\">\n        Black: {game.black ? game.black.fullName : `AI level ${game.aiLevel}`}\n      </div>\n    </>\n  );\n};\n","import Game from \"../interfaces/Game\";\n\nexport default (game: Game): string => {\n  if (game.status === \"outoftime\") {\n    if (game.winner === \"white\") {\n      return \"Time out • White is victorious\";\n    }\n    if (game.winner === \"black\") {\n      return \"Time out • Black is victorious\";\n    }\n  }\n\n  if (game.status === \"resign\") {\n    if (game.winner === \"black\") {\n      return \"White resigned • Black is victorious\";\n    }\n    if (game.winner === \"white\") {\n      return \"Black resigned • White is victorious\";\n    }\n  }\n\n  if (game.status === \"aborted\") {\n    return \"Game aborted\";\n  }\n\n  if (game.status === \"mate\") {\n    if (game.winner === \"white\") {\n      return \"Checkmate • White is victorious\";\n    }\n    if (game.winner === \"black\") {\n      return \"Checkmate • Black is victorious\";\n    }\n  }\n\n  if (game.status === \"draw\") {\n    return \"Draw\";\n  }\n\n  if (game.status === \"stalemate\") {\n    return \"Stalemate\";\n  }\n\n  return \"Playing right now\";\n};\n","import React, { FC } from \"react\";\nimport moment from \"moment\";\n\nexport interface GameClockProps {\n  time?: number; // in msec\n}\n\nexport const GameClock: FC<GameClockProps> = ({ time = 0 }) => {\n  const formattedTime = moment()\n    .startOf(\"day\")\n    .milliseconds(time)\n    .format(\"mm : ss\");\n\n  return <div data-testid=\"time\">{formattedTime}</div>;\n};\n","/* eslint-disable react/no-array-index-key */\n/* eslint-disable jsx-a11y/click-events-have-key-events */ // @todo\n/* eslint-disable jsx-a11y/interactive-supports-focus */ // @todo\n\nimport React, { FC } from \"react\";\nimport { chunk as _chunk } from \"lodash\";\nimport { Move } from \"chess.js\";\nimport Game from \"../../interfaces/Game\";\nimport makeChessInstance from \"../../utils/makeChessInstance\";\n\nexport interface GameMovesProps {\n  game?: Game;\n  onRewindToMove?(moveIndex: number): void;\n}\n\nconst formatMove = (move: Move): string => {\n  return `${move.from}${move.to}`;\n};\n\nexport const GameMoves: FC<GameMovesProps> = ({ game, onRewindToMove }) => {\n  if (!game) {\n    return null;\n  }\n\n  const chess = makeChessInstance(game);\n\n  const movesHistory = chess.history({ verbose: true });\n\n  const movesPairs = _chunk(movesHistory, 2);\n\n  const makeRewindToMoveHandler = (moveIndex: number) => {\n    return () => {\n      if (onRewindToMove) {\n        onRewindToMove(moveIndex);\n      }\n    };\n  };\n\n  return (\n    <table>\n      <tbody>\n        {movesPairs.map((pair, index) => (\n          <tr key={`move-${index}`}>\n            <td>{index + 1}</td>\n            <td>\n              <div\n                data-testid={`move-${index * 2}`}\n                onClick={makeRewindToMoveHandler(index * 2)}\n                role=\"button\"\n              >\n                {formatMove(pair[0])}\n              </div>\n            </td>\n            <td>\n              {pair[1] && (\n                <div\n                  data-testid={`move-${index * 2 + 1}`}\n                  onClick={makeRewindToMoveHandler(index * 2 + 1)}\n                  role=\"button\"\n                >\n                  {formatMove(pair[1])}\n                </div>\n              )}\n            </td>\n          </tr>\n        ))}\n      </tbody>\n    </table>\n  );\n};\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\n\nimport React, { FC } from \"react\";\nimport Game from \"../../interfaces/Game\";\nimport { PieceColor } from \"../../types/PieceColor\";\n\nexport interface GameControlPanelUserNameProps {\n  game?: Game;\n  color?: PieceColor;\n}\n\nexport const GameControlPanelUserName: FC<GameControlPanelUserNameProps> = ({\n  game,\n  color = \"white\",\n}) => {\n  if (!game) {\n    return null;\n  }\n\n  return (\n    <div>\n      {game[color] ? game[color]!.fullName : `AI level ${game.aiLevel}`}\n    </div>\n  );\n};\n","import React, { FC, useCallback } from \"react\";\n\nexport interface GameControlPanelTopToolbarProps {\n  onFlipBoard?(): void;\n  onRewindToPrevMove?(): void;\n  onRewindToNextMove?(): void;\n  onRewindToFirstMove?(): void;\n  onRewindToLastMove?(): void;\n}\n\nexport const GameControlPanelTopToolbar: FC<GameControlPanelTopToolbarProps> = ({\n  onFlipBoard,\n  onRewindToPrevMove,\n  onRewindToNextMove,\n  onRewindToFirstMove,\n  onRewindToLastMove,\n}) => {\n  const handleFlipBoard = useCallback(() => {\n    if (onFlipBoard) {\n      onFlipBoard();\n    }\n  }, [onFlipBoard]);\n  const handleRewindToPrevMove = useCallback(() => {\n    if (onRewindToPrevMove) {\n      onRewindToPrevMove();\n    }\n  }, [onRewindToPrevMove]);\n  const handleRewindToNextMove = useCallback(() => {\n    if (onRewindToNextMove) {\n      onRewindToNextMove();\n    }\n  }, [onRewindToNextMove]);\n  const handleRewindToFirstMove = useCallback(() => {\n    if (onRewindToFirstMove) {\n      onRewindToFirstMove();\n    }\n  }, [onRewindToFirstMove]);\n  const handleRewindToLastMove = useCallback(() => {\n    if (onRewindToLastMove) {\n      onRewindToLastMove();\n    }\n  }, [onRewindToLastMove]);\n\n  return (\n    <>\n      <button\n        type=\"button\"\n        data-testid=\"flip-board-btn\"\n        onClick={handleFlipBoard}\n      >\n        Flip board\n      </button>\n      <button\n        type=\"button\"\n        data-testid=\"rewind-to-prev-move-btn\"\n        onClick={handleRewindToPrevMove}\n      >\n        Rewind to prev move\n      </button>\n      <button\n        type=\"button\"\n        data-testid=\"rewind-to-first-move-btn\"\n        onClick={handleRewindToFirstMove}\n      >\n        Rewind to first move\n      </button>\n      <button\n        type=\"button\"\n        data-testid=\"rewind-to-last-move-btn\"\n        onClick={handleRewindToLastMove}\n      >\n        Rewind to last move\n      </button>\n      <button\n        type=\"button\"\n        data-testid=\"rewind-to-next-move-btn\"\n        onClick={handleRewindToNextMove}\n      >\n        Rewind to next move\n      </button>\n    </>\n  );\n};\n","import React, { FC, useCallback } from \"react\";\n\nexport interface GameControlPanelBottomToolbarProps {\n  onAbortGame?(): void;\n  onOfferDraw?(): void;\n  onResignGame?(): void;\n}\n\nexport const GameControlPanelBottomToolbar: FC<GameControlPanelBottomToolbarProps> = ({\n  onAbortGame,\n  onOfferDraw,\n  onResignGame,\n}) => {\n  const handleAbortGame = useCallback(() => {\n    if (onAbortGame) {\n      onAbortGame();\n    }\n  }, [onAbortGame]);\n  const handleOfferDraw = useCallback(() => {\n    if (onOfferDraw) {\n      onOfferDraw();\n    }\n  }, [onOfferDraw]);\n  const handleResignGame = useCallback(() => {\n    if (onResignGame) {\n      onResignGame();\n    }\n  }, [onResignGame]);\n\n  return (\n    <>\n      <button\n        type=\"button\"\n        data-testid=\"abort-game-btn\"\n        onClick={handleAbortGame}\n      >\n        Abort\n      </button>\n      <button\n        type=\"button\"\n        data-testid=\"offer-draw-btn\"\n        onClick={handleOfferDraw}\n      >\n        Offer a draw\n      </button>\n      <button\n        type=\"button\"\n        data-testid=\"resign-game-btn\"\n        onClick={handleResignGame}\n      >\n        Resign\n      </button>\n    </>\n  );\n};\n","import React, { FC } from \"react\";\nimport Game from \"../../interfaces/Game\";\nimport { PieceColor } from \"../../types/PieceColor\";\nimport { GameClock } from \"./GameClock\";\nimport { GameMoves } from \"./GameMoves\";\nimport { GameControlPanelUserName } from \"./GameControlPanelUserName\";\nimport { GameControlPanelTopToolbar } from \"./GameControlPanelTopToolbar\";\nimport { GameControlPanelBottomToolbar } from \"./GameControlPanelBottomToolbar\";\n\nexport interface GameControlPanelProps {\n  game?: Game;\n  orientation?: PieceColor;\n  onRewindToMove?(moveIndex: number): void;\n  onFlipBoard?(): void;\n  onRewindToPrevMove?(): void;\n  onRewindToNextMove?(): void;\n  onRewindToFirstMove?(): void;\n  onRewindToLastMove?(): void;\n  onAbortGame?(): void;\n  onOfferDraw?(): void;\n  onResignGame?(): void;\n}\n\nexport const GameControlPanel: FC<GameControlPanelProps> = ({\n  game,\n  orientation = \"white\",\n  onRewindToMove,\n  onFlipBoard,\n  onRewindToPrevMove,\n  onRewindToNextMove,\n  onRewindToFirstMove,\n  onRewindToLastMove,\n  onAbortGame,\n  onOfferDraw,\n  onResignGame,\n}) => {\n  if (!game) {\n    return null;\n  }\n\n  return (\n    <div>\n      <GameClock time={orientation === \"white\" ? game.btime : game.wtime} />\n      <GameControlPanelUserName\n        game={game}\n        color={orientation === \"white\" ? \"black\" : \"white\"}\n      />\n      <GameControlPanelTopToolbar\n        onFlipBoard={onFlipBoard}\n        onRewindToPrevMove={onRewindToPrevMove}\n        onRewindToNextMove={onRewindToNextMove}\n        onRewindToFirstMove={onRewindToFirstMove}\n        onRewindToLastMove={onRewindToLastMove}\n      />\n      <GameMoves game={game} onRewindToMove={onRewindToMove} />\n      <GameControlPanelBottomToolbar\n        onAbortGame={onAbortGame}\n        onOfferDraw={onOfferDraw}\n        onResignGame={onResignGame}\n      />\n      <GameControlPanelUserName\n        game={game}\n        color={orientation === \"white\" ? \"white\" : \"black\"}\n      />\n      <GameClock time={orientation === \"white\" ? game.wtime : game.btime} />\n    </div>\n  );\n};\n","import React, { FC } from \"react\";\nimport { ChessInstance } from \"chess.js\";\nimport {\n  Board,\n  getValidMoves,\n  Move,\n  PieceColor,\n  ValidMoves,\n} from \"ii-react-chessboard\";\nimport Game from \"../../interfaces/Game\";\nimport makeChessInstance from \"../../utils/makeChessInstance\";\nimport User from \"../../interfaces/User\";\nimport { GameMeta } from \"./GameMeta\";\nimport { GameControlPanel } from \"./GameControlPanel\";\n\nexport interface SingleGameProps {\n  game?: Game;\n  currentUser?: User;\n  onMove?(move: Move): void;\n}\n\nexport const SingleGame: FC<SingleGameProps> = ({\n  game,\n  currentUser,\n  onMove,\n}) => {\n  if (!game) {\n    return null;\n  }\n\n  const chess: ChessInstance = makeChessInstance(game);\n\n  const check: boolean = chess.in_check();\n\n  const fen: string = chess.fen();\n\n  const turnColor: PieceColor =\n    game.turn === \"white\" ? PieceColor.WHITE : PieceColor.BLACK;\n\n  const validMoves: ValidMoves = getValidMoves(chess);\n\n  let viewOnly = true;\n  if (\n    currentUser &&\n    (currentUser.id === game.white?.id || currentUser.id === game.black?.id) &&\n    game.status === \"started\"\n  ) {\n    viewOnly = false;\n  }\n\n  let movableColor: PieceColor | undefined;\n  if (currentUser && currentUser.id === game.white?.id) {\n    movableColor = PieceColor.WHITE;\n  }\n  if (currentUser && currentUser.id === game.black?.id) {\n    movableColor = PieceColor.BLACK;\n  }\n\n  let orientation = PieceColor.WHITE;\n  if (currentUser && currentUser.id === game.black?.id) {\n    orientation = PieceColor.BLACK;\n  }\n\n  const movesHistory = chess.history({ verbose: true });\n\n  let lastMoveSquares: string[] | undefined;\n  if (movesHistory.length) {\n    const lastMove = movesHistory[movesHistory.length - 1];\n    lastMoveSquares = [lastMove.from, lastMove.to];\n  }\n\n  return (\n    <>\n      <GameMeta game={game} />\n      <GameControlPanel game={game} orientation={orientation} />\n      <Board\n        allowMarkers\n        check={check}\n        clickable\n        draggable\n        orientation={orientation}\n        position={fen}\n        turnColor={turnColor}\n        lastMoveSquares={lastMoveSquares}\n        movableColor={movableColor}\n        validMoves={validMoves}\n        viewOnly={viewOnly}\n        onMove={onMove}\n      />\n    </>\n  );\n};\n","import React, { FC, useEffect } from \"react\";\nimport { denormalize } from \"normalizr\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { Move } from \"ii-react-chessboard\";\nimport { SingleGame } from \"./SingleGame\";\nimport { AppDispatch } from \"../../app/store\";\nimport { RootState } from \"../../app/rootReducer\";\nimport gameSchema from \"../../normalizr/schemas/gameSchema\";\nimport { fetchGame } from \"./singleGameSlice\";\nimport { makeMove } from \"../move/moveSlice\";\nimport User from \"../../interfaces/User\";\nimport userSchema from \"../../normalizr/schemas/userSchema\";\n\nexport interface SingleGameContainerProps {\n  id: number;\n}\n\nexport const SingleGameContainer: FC<SingleGameContainerProps> = ({ id }) => {\n  const dispatch = useDispatch<AppDispatch>();\n\n  const game = useSelector((state: RootState) =>\n    denormalize(id, gameSchema, state.entities)\n  );\n\n  const currentUser: User | undefined = useSelector((state: RootState) => {\n    if (state.currentUser.userId) {\n      return denormalize(state.currentUser.userId, userSchema, state.entities);\n    }\n    return undefined;\n  });\n\n  useEffect(() => {\n    dispatch(fetchGame(id));\n  }, [dispatch, id]);\n\n  const onMove = (move: Move) => {\n    dispatch(makeMove(id, `${move.from}${move.to}`));\n  };\n\n  if (game) {\n    return <SingleGame game={game} currentUser={currentUser} onMove={onMove} />;\n  }\n  return null;\n};\n","import React, { FC } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { SingleGameContainer } from \"../features/single-game/SingleGameContainer\";\n\ninterface GamePageParams {\n  id: string;\n}\n\nconst GamePage: FC<unknown> = () => {\n  const { id } = useParams<GamePageParams>();\n\n  return <SingleGameContainer id={Number(id)} />;\n};\n\nexport default GamePage;\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport React, { FC, FormEvent } from \"react\";\nimport { Formik, FormikHelpers } from \"formik\";\nimport { Alert, Button, Form } from \"react-bootstrap\";\nimport * as Yup from \"yup\";\nimport LoginData from \"../../interfaces/LoginData\";\n\nconst loginSchema = Yup.object().shape({\n  email: Yup.string().email(\"Invalid email\").required(\"Required\"),\n  password: Yup.string()\n    .min(6, \"Password length must be >= 6\")\n    .required(\"Required\"),\n});\n\nexport interface LoginFormProps {\n  onSubmit?(\n    values: LoginData,\n    formikHelpers: FormikHelpers<LoginData>\n  ): void | Promise<any>;\n}\n\nexport const LoginForm: FC<LoginFormProps> = ({ onSubmit }) => {\n  return (\n    <Formik\n      initialValues={{ email: \"\", password: \"\" }}\n      validationSchema={loginSchema}\n      onSubmit={(values, formikHelpers): Promise<any> | void => {\n        if (onSubmit) {\n          return onSubmit(values as LoginData, formikHelpers);\n        }\n        return undefined;\n      }}\n    >\n      {({\n        errors,\n        values,\n        touched,\n        handleChange,\n        handleBlur,\n        handleSubmit,\n        isSubmitting,\n        status,\n        setStatus,\n        /* and other goodies */\n      }) => (\n        <Form\n          noValidate\n          onSubmit={(e) => handleSubmit(e as FormEvent<HTMLFormElement>)}\n          onChange={() => setStatus(\"\")}\n        >\n          {!!status && <Alert variant=\"danger\">{status}</Alert>}\n          <Form.Group>\n            <Form.Label>Email address</Form.Label>\n            <Form.Control\n              type=\"email\"\n              name=\"email\"\n              placeholder=\"Enter email\"\n              onBlur={handleBlur}\n              value={values.email}\n              onChange={handleChange}\n              isValid={touched.email && !errors.email}\n              isInvalid={touched.email && !!errors.email}\n            />\n            <Form.Control.Feedback type=\"invalid\">\n              {errors.email}\n            </Form.Control.Feedback>\n          </Form.Group>\n\n          <Form.Group>\n            <Form.Label>Password</Form.Label>\n            <Form.Control\n              type=\"password\"\n              name=\"password\"\n              placeholder=\"Password\"\n              onChange={handleChange}\n              onBlur={handleBlur}\n              value={values.password}\n              isValid={touched.password && !errors.password}\n              isInvalid={touched.password && !!errors.password}\n            />\n            <Form.Control.Feedback type=\"invalid\">\n              {errors.password}\n            </Form.Control.Feedback>\n          </Form.Group>\n          <Button variant=\"primary\" type=\"submit\" disabled={isSubmitting}>\n            Login\n          </Button>\n        </Form>\n      )}\n    </Formik>\n  );\n};\n","/* eslint-disable @typescript-eslint/no-explicit-any */\n\nimport React, { FC, FormEvent } from \"react\";\nimport { Formik } from \"formik\";\nimport { Alert, Button, Form } from \"react-bootstrap\";\nimport * as Yup from \"yup\";\nimport { FormikHelpers } from \"formik/dist/types\";\n\nconst registrationSchema = Yup.object().shape({\n  fullName: Yup.string().required(\"Required\"),\n  email: Yup.string().email(\"Invalid email\").required(\"Required\"),\n  password: Yup.string()\n    .min(6, \"Password length must be >= 6\")\n    .required(\"Required\"),\n  confirmPassword: Yup.string()\n    .equals([Yup.ref(\"password\")], \"Please repeat the password\")\n    .required(\"Required\"),\n});\n\nexport interface RegistrationFormData {\n  fullName: string;\n  email: string;\n  password: string;\n  confirmPassword: string;\n}\n\nexport interface RegistrationFormProps {\n  onSubmit?(\n    values: RegistrationFormData,\n    formikHelpers: FormikHelpers<RegistrationFormData>\n  ): void | Promise<any>;\n}\n\nexport const RegistrationForm: FC<RegistrationFormProps> = ({ onSubmit }) => {\n  return (\n    <Formik\n      initialValues={{\n        fullName: \"\",\n        email: \"\",\n        password: \"\",\n        confirmPassword: \"\",\n      }}\n      validationSchema={registrationSchema}\n      onSubmit={(values, formikHelpers): Promise<any> | void => {\n        if (onSubmit) {\n          return onSubmit(values as RegistrationFormData, formikHelpers);\n        }\n        return undefined;\n      }}\n    >\n      {({\n        errors,\n        values,\n        touched,\n        handleChange,\n        handleBlur,\n        handleSubmit,\n        isSubmitting,\n        status,\n        setStatus,\n        /* and other goodies */\n      }) => (\n        <Form\n          noValidate\n          onSubmit={(e) => handleSubmit(e as FormEvent<HTMLFormElement>)}\n          onChange={() => setStatus(\"\")}\n        >\n          {!!status && <Alert variant=\"danger\">{status}</Alert>}\n\n          <Form.Group>\n            <Form.Label>Full name</Form.Label>\n            <Form.Control\n              type=\"text\"\n              name=\"fullName\"\n              placeholder=\"Enter full name\"\n              onBlur={handleBlur}\n              value={values.fullName}\n              onChange={handleChange}\n              isValid={touched.fullName && !errors.fullName}\n              isInvalid={touched.fullName && !!errors.fullName}\n            />\n            <Form.Control.Feedback type=\"invalid\">\n              {errors.fullName}\n            </Form.Control.Feedback>\n          </Form.Group>\n\n          <Form.Group>\n            <Form.Label>Email address</Form.Label>\n            <Form.Control\n              type=\"email\"\n              name=\"email\"\n              placeholder=\"Enter email\"\n              onBlur={handleBlur}\n              value={values.email}\n              onChange={handleChange}\n              isValid={touched.email && !errors.email}\n              isInvalid={touched.email && !!errors.email}\n            />\n            <Form.Control.Feedback type=\"invalid\">\n              {errors.email}\n            </Form.Control.Feedback>\n          </Form.Group>\n\n          <Form.Group>\n            <Form.Label>Password</Form.Label>\n            <Form.Control\n              type=\"password\"\n              name=\"password\"\n              placeholder=\"Password\"\n              onChange={handleChange}\n              onBlur={handleBlur}\n              value={values.password}\n              isValid={touched.password && !errors.password}\n              isInvalid={touched.password && !!errors.password}\n            />\n            <Form.Control.Feedback type=\"invalid\">\n              {errors.password}\n            </Form.Control.Feedback>\n          </Form.Group>\n\n          <Form.Group>\n            <Form.Label>Confirm Password</Form.Label>\n            <Form.Control\n              type=\"password\"\n              name=\"confirmPassword\"\n              placeholder=\"Password\"\n              onChange={handleChange}\n              onBlur={handleBlur}\n              value={values.confirmPassword}\n              isValid={touched.confirmPassword && !errors.confirmPassword}\n              isInvalid={touched.confirmPassword && !!errors.confirmPassword}\n            />\n            <Form.Control.Feedback type=\"invalid\">\n              {errors.confirmPassword}\n            </Form.Control.Feedback>\n          </Form.Group>\n\n          <Button variant=\"primary\" type=\"submit\" disabled={isSubmitting}>\n            Register\n          </Button>\n        </Form>\n      )}\n    </Formik>\n  );\n};\n","import React, { FC } from \"react\";\nimport { Tab, Tabs } from \"react-bootstrap\";\nimport { useDispatch } from \"react-redux\";\nimport { FormikHelpers } from \"formik\";\nimport { LoginForm } from \"./LoginForm\";\nimport { RegistrationForm, RegistrationFormData } from \"./RegistrationForm\";\nimport LoginData from \"../../interfaces/LoginData\";\nimport { login, register } from \"../current-user/currentUserSlice\";\nimport { AppDispatch } from \"../../app/store\";\n\nconst LoginTabsContainer: FC<unknown> = () => {\n  const dispatch = useDispatch<AppDispatch>();\n\n  const doLogin = React.useCallback(\n    (values: LoginData, formikHelpers: FormikHelpers<LoginData>) => {\n      return dispatch(login(values)).catch((err) => {\n        if (err.statusCode === 401) {\n          formikHelpers.setStatus(\"Incorrect email or password\");\n        } else {\n          formikHelpers.setStatus(\"Internal server error\");\n        }\n      });\n    },\n    [dispatch]\n  );\n\n  const doSignUp = React.useCallback(\n    (\n      values: RegistrationFormData,\n      formikHelpers: FormikHelpers<RegistrationFormData>\n    ) => {\n      return dispatch(\n        register({\n          fullName: values.fullName,\n          email: values.email,\n          password: values.password,\n        })\n      ).catch((err) => {\n        if (err.statusCode === 409) {\n          formikHelpers.setStatus(\n            \"The provided email address is already in use\"\n          );\n        } else {\n          formikHelpers.setStatus(\"Internal server error\");\n        }\n      });\n    },\n    [dispatch]\n  );\n\n  return (\n    <Tabs transition={false}>\n      <Tab eventKey=\"home\" title=\"Login\">\n        <LoginForm onSubmit={doLogin} />\n      </Tab>\n      <Tab eventKey=\"profile\" title=\"Register\">\n        <RegistrationForm onSubmit={doSignUp} />\n      </Tab>\n    </Tabs>\n  );\n};\n\nexport default LoginTabsContainer;\n","import React, { FC, useEffect } from \"react\";\nimport { BrowserRouter as Router, Switch, Route, Link } from \"react-router-dom\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { denormalize } from \"normalizr\";\nimport { Button, Modal } from \"react-bootstrap\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport HomePage from \"../pages/HomePage\";\nimport GamePage from \"../pages/GamePage\";\nimport LoginTabsContainer from \"../features/auth-modal/LoginTabsContainer\";\nimport { RootState } from \"./rootReducer\";\nimport {\n  fetchCurrentUser,\n  logout,\n} from \"../features/current-user/currentUserSlice\";\nimport {\n  showAuthModal,\n  hideAuthModal,\n} from \"../features/auth-modal/authModalSlice\";\nimport User from \"../interfaces/User\";\nimport userSchema from \"../normalizr/schemas/userSchema\";\nimport { watchGames } from \"../features/data-subscription/dataSubscriptionSlice\";\nimport { startGameClock } from \"../features/game-clock/gameClockSlice\";\n\nconst App: FC = () => {\n  const dispatch = useDispatch();\n\n  const currentUser: User | null = useSelector((state: RootState) => {\n    if (state.currentUser.userId) {\n      return denormalize(state.currentUser.userId, userSchema, state.entities);\n    }\n    return null;\n  });\n  const { isAuthModalVisible } = useSelector(\n    (state: RootState) => state.authModal\n  );\n\n  useEffect(() => {\n    dispatch(fetchCurrentUser());\n    dispatch(watchGames());\n    dispatch(startGameClock());\n  }, [dispatch]);\n\n  return (\n    <Router>\n      {currentUser ? (\n        <>\n          <div>Hi, {currentUser.fullName}</div>\n          <Button variant=\"primary\" onClick={() => dispatch(logout())}>\n            Logout\n          </Button>\n        </>\n      ) : (\n        <Button variant=\"primary\" onClick={() => dispatch(showAuthModal())}>\n          Login / Register\n        </Button>\n      )}\n\n      <Modal\n        show={isAuthModalVisible}\n        onHide={() => dispatch(hideAuthModal())}\n        animation={false}\n      >\n        <Modal.Header closeButton>\n          <Modal.Title>Login</Modal.Title>\n        </Modal.Header>\n\n        <Modal.Body>\n          <LoginTabsContainer />\n        </Modal.Body>\n      </Modal>\n      <div>\n        <nav>\n          <ul>\n            <li>\n              <Link to=\"/\">Home</Link>\n            </li>\n          </ul>\n        </nav>\n\n        <Switch>\n          <Route path=\"/game/:id\">\n            <GamePage />\n          </Route>\n          <Route path=\"/\">\n            <HomePage />\n          </Route>\n        </Switch>\n      </div>\n    </Router>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === \"localhost\" ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === \"[::1]\" ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === \"production\" && \"serviceWorker\" in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener(\"load\", () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            \"This web app is being served cache-first by a service \" +\n              \"worker. To learn more, visit https://bit.ly/CRA-PWA\"\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === \"installed\") {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                \"New content is available and will be used when all \" +\n                  \"tabs for this page are closed. See https://bit.ly/CRA-PWA.\"\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log(\"Content is cached for offline use.\");\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error(\"Error during service worker registration:\", error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { \"Service-Worker\": \"script\" },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get(\"content-type\");\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf(\"javascript\") === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    });\n}\n\nexport function unregister() {\n  if (\"serviceWorker\" in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","/* eslint-disable no-param-reassign */\n/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable import/no-cycle */\n\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport {\n  getCurrentUserSuccess,\n  loginSuccess,\n  registerSuccess,\n} from \"../current-user/currentUserSlice\";\nimport { getOngoingGamesSuccess } from \"../ongoing-games/ongoingGamesSlice\";\nimport { getSingleGameSuccess } from \"../single-game/singleGameSlice\";\nimport { challengeAiSuccess } from \"../challenge/challengeSlice\";\nimport { oneSecondPassed } from \"../game-clock/gameClockSlice\";\nimport {\n  updateGameBySubscription,\n  createGameBySubscription,\n} from \"../data-subscription/dataSubscriptionSlice\";\nimport {\n  makeMoveRequest,\n  makeMoveSuccess,\n  MoveRequestPayload,\n} from \"../move/moveSlice\";\nimport NormalizedUserEntity from \"../../normalizr/interfaces/NormalizedUserEntity\";\nimport NormalizedGameEntity from \"../../normalizr/interfaces/NormalizedGameEntity\";\n\nexport interface EntitiesState {\n  users: Record<string, NormalizedUserEntity>;\n  games: Record<string, NormalizedGameEntity>;\n}\n\nconst initialState: EntitiesState = {\n  users: {},\n  games: {},\n};\n\nconst getNormalizedDataReducer = (\n  state: EntitiesState,\n  action: PayloadAction<{\n    entities: Partial<EntitiesState>;\n  }>\n) => {\n  Object.assign(state.users, action.payload.entities.users);\n  Object.assign(state.games, action.payload.entities.games);\n};\n\nconst entitiesSlice = createSlice({\n  name: \"entities\",\n  initialState,\n  reducers: {},\n  extraReducers: {\n    [getCurrentUserSuccess.type]: (\n      state: EntitiesState,\n      action: PayloadAction<null | {\n        entities: Partial<EntitiesState>;\n      }>\n    ) => {\n      if (action.payload) {\n        getNormalizedDataReducer(state, {\n          type: action.type,\n          payload: action.payload,\n        });\n      }\n    },\n    [loginSuccess.type]: getNormalizedDataReducer,\n    [registerSuccess.type]: getNormalizedDataReducer,\n    [getOngoingGamesSuccess.type]: getNormalizedDataReducer,\n    [getSingleGameSuccess.type]: getNormalizedDataReducer,\n    [challengeAiSuccess.type]: getNormalizedDataReducer,\n    [updateGameBySubscription.type]: getNormalizedDataReducer,\n    [createGameBySubscription.type]: getNormalizedDataReducer,\n    [makeMoveRequest.type]: (\n      state: EntitiesState,\n      action: PayloadAction<MoveRequestPayload>\n    ) => {\n      state.games[action.payload.gameId].turn =\n        state.games[action.payload.gameId].turn === \"white\" ? \"black\" : \"white\";\n      state.games[action.payload.gameId].moves = `${\n        state.games[action.payload.gameId].moves\n      } ${action.payload.move}`.trim();\n    },\n    [makeMoveSuccess.type]: getNormalizedDataReducer,\n    [oneSecondPassed.type]: (state: EntitiesState) => {\n      const gameIds = Object.keys(state.games);\n\n      gameIds.forEach((gameId) => {\n        const game = state.games[gameId];\n\n        if (game.status === \"started\") {\n          const timePropName = game.turn === \"white\" ? \"wtime\" : \"btime\";\n\n          game[timePropName] -= 1000;\n          if (game[timePropName] < 0) {\n            game[timePropName] = 0;\n          }\n\n          if (game[timePropName] === 0) {\n            game.status = \"outoftime\";\n            game.winner = game.turn === \"white\" ? \"black\" : \"white\";\n          }\n        }\n      });\n    },\n  },\n});\n\nexport default entitiesSlice.reducer;\n","/* eslint-disable import/no-cycle */\n\nimport { combineReducers } from \"@reduxjs/toolkit\";\nimport ongoingGamesReducer from \"../features/ongoing-games/ongoingGamesSlice\";\nimport currentUserReducer from \"../features/current-user/currentUserSlice\";\nimport authModalReducer from \"../features/auth-modal/authModalSlice\";\nimport challengeAiModalReducer from \"../features/challenge-ai-modal/challengeAiModalSlice\";\nimport entitiesReducer from \"../features/entities/entitiesSlice\";\nimport singleGameReducer from \"../features/single-game/singleGameSlice\";\n// import dataSubscriptionReducer from \"../redux/slices/dataSubscriptionSlice\";\n\nconst rootReducer = combineReducers({\n  authModal: authModalReducer,\n  challengeAiModal: challengeAiModalReducer,\n  // challenge: challengeReducer,\n  currentUser: currentUserReducer,\n  ongoingGames: ongoingGamesReducer,\n  entities: entitiesReducer,\n  // dataSubscription: dataSubscriptionReducer,\n  singleGame: singleGameReducer,\n});\n\nexport type RootState = ReturnType<typeof rootReducer>;\n\nexport default rootReducer;\n","/* eslint-disable global-require */\n/* eslint-disable @typescript-eslint/no-var-requires */\n/* eslint-disable import/no-cycle */\n\nimport { Action, configureStore } from \"@reduxjs/toolkit\";\nimport { ThunkAction } from \"redux-thunk\";\nimport rootReducer, { RootState } from \"./rootReducer\";\n\nconst store = configureStore({\n  reducer: rootReducer,\n});\n\nif (process.env.NODE_ENV === \"development\" && module.hot) {\n  module.hot.accept(\"./rootReducer\", () => {\n    const newRootReducer = require(\"./rootReducer\").default;\n    store.replaceReducer(newRootReducer);\n  });\n}\n\nexport type AppDispatch = typeof store.dispatch;\n\nexport type AppThunk<R> = ThunkAction<R, RootState, unknown, Action<string>>;\n\nexport default store;\n","/* eslint-disable global-require */\n/* eslint-disable @typescript-eslint/no-var-requires */\n\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { Provider } from \"react-redux\";\nimport \"./index.css\";\nimport * as serviceWorker from \"./serviceWorker\";\nimport store from \"./app/store\";\n\nconst render = () => {\n  const App = require(\"./app/App\").default;\n\n  ReactDOM.render(\n    <React.StrictMode>\n      <Provider store={store}>\n        <App />\n      </Provider>\n    </React.StrictMode>,\n    document.getElementById(\"root\")\n  );\n};\n\nrender();\n\nif (process.env.NODE_ENV === \"development\" && module.hot) {\n  module.hot.accept(\"./app/App\", render);\n}\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","import { schema } from \"normalizr\";\n\nconst userSchema = new schema.Entity(\"users\");\n\nexport default userSchema;\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"levelButtonGroup\":\"ChallengeAiForm_levelButtonGroup__1lnm_\",\"colorSubmits\":\"ChallengeAiForm_colorSubmits__1pM28\",\"colorSubmitsButton\":\"ChallengeAiForm_colorSubmitsButton__2P6Lx\",\"whiteButton\":\"ChallengeAiForm_whiteButton__2nTjs\",\"blackButton\":\"ChallengeAiForm_blackButton__1LVeL\",\"randomButton\":\"ChallengeAiForm_randomButton__1S07l\"};","/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable @typescript-eslint/no-empty-interface */\n/* eslint-disable import/no-cycle */\n\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { JWR } from \"sails.io.js\";\nimport { normalize } from \"normalizr\";\nimport NormalizedData from \"../../normalizr/interfaces/NormalizedData\";\nimport { ChallengeAiData } from \"../../interfaces/ChallengeAiData\";\nimport { AppThunk } from \"../../app/store\";\nimport Game from \"../../interfaces/Game\";\nimport ioClient from \"../../services/ioClient\";\nimport gameSchema from \"../../normalizr/schemas/gameSchema\";\n\ninterface ChallengeState {}\n\nconst initialState: ChallengeState = {};\n\nconst challengeSlice = createSlice({\n  name: \"challenge\",\n  initialState,\n  reducers: {\n    challengeAiRequest() {},\n    challengeAiSuccess(\n      _state,\n      _action: PayloadAction<NormalizedData<number>>\n    ) {},\n    challengeAiError(_state, _action: PayloadAction<string>) {},\n  },\n  extraReducers: {},\n});\n\nexport const {\n  challengeAiRequest,\n  challengeAiSuccess,\n  challengeAiError,\n} = challengeSlice.actions;\n\nexport default challengeSlice.reducer;\n\nexport const challengeAi = (data: ChallengeAiData): AppThunk<Promise<Game>> => (\n  dispatch\n) => {\n  dispatch(challengeAiRequest());\n\n  return new Promise((resolve, reject) => {\n    ioClient.socket.post(\n      `/api/v1/challenge/ai`,\n      data,\n      (body: unknown, jwr: JWR) => {\n        if (jwr.statusCode === 200) {\n          const normalizedGame = normalize(body as Game, gameSchema);\n\n          dispatch(challengeAiSuccess(normalizedGame));\n          resolve(body as Game);\n        } else {\n          dispatch(challengeAiError(body as string));\n          reject(jwr);\n        }\n      }\n    );\n  });\n};\n","/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable @typescript-eslint/no-empty-interface */\n/* eslint-disable import/no-cycle */\n\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { normalize } from \"normalizr\";\nimport NormalizedData from \"../../normalizr/interfaces/NormalizedData\";\nimport { AppThunk } from \"../../app/store\";\nimport ioClient from \"../../services/ioClient\";\nimport { SubscriptionData } from \"../../interfaces/SubscriptionData\";\nimport gameSchema from \"../../normalizr/schemas/gameSchema\";\n\ninterface DataSubscriptionState {}\n\nconst initialState: DataSubscriptionState = {};\n\nconst dataSubscriptionSlice = createSlice({\n  name: \"dataSubscription\",\n  initialState,\n  reducers: {\n    updateGameBySubscription(\n      _state,\n      _action: PayloadAction<NormalizedData<number>>\n    ) {},\n    createGameBySubscription(\n      _state,\n      _action: PayloadAction<NormalizedData<number>>\n    ) {},\n  },\n  extraReducers: {},\n});\n\nexport const {\n  updateGameBySubscription,\n  createGameBySubscription,\n} = dataSubscriptionSlice.actions;\n\nexport default dataSubscriptionSlice.reducer;\n\nexport const watchGames = (): AppThunk<void> => (dispatch) => {\n  ioClient.socket.on(\"game\", (subscriptionData: SubscriptionData) => {\n    if (subscriptionData.verb === \"updated\") {\n      const game = {\n        ...subscriptionData.previous,\n        ...subscriptionData.data,\n      };\n\n      const normalizedGame = normalize(game, gameSchema);\n\n      dispatch(updateGameBySubscription(normalizedGame));\n    } else if (subscriptionData.verb === \"created\") {\n      const normalizedGame = normalize(subscriptionData.data, gameSchema);\n\n      dispatch(createGameBySubscription(normalizedGame));\n    }\n  });\n};\n","/* eslint-disable no-param-reassign */\n/* eslint-disable import/no-cycle */\n\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { JWR } from \"sails.io.js\";\nimport { normalize } from \"normalizr\";\nimport { AppThunk } from \"../../app/store\";\nimport Game from \"../../interfaces/Game\";\nimport ioClient from \"../../services/ioClient\";\nimport gameSchema from \"../../normalizr/schemas/gameSchema\";\nimport NormalizedData from \"../../normalizr/interfaces/NormalizedData\";\nimport { challengeAiSuccess } from \"../challenge/challengeSlice\";\nimport {\n  createGameBySubscription,\n  updateGameBySubscription,\n} from \"../data-subscription/dataSubscriptionSlice\";\n\ninterface OngoingGamesState {\n  items: number[];\n  isLoading: boolean;\n  error: string | null;\n}\n\nconst initialState: OngoingGamesState = {\n  items: [],\n  isLoading: true,\n  error: null,\n};\n\nconst ongoingGamesSlice = createSlice({\n  name: \"ongoingGames\",\n  initialState,\n  reducers: {\n    getOngoingGamesRequest(state) {\n      state.isLoading = true;\n      state.error = null;\n    },\n    getOngoingGamesSuccess(\n      state,\n      action: PayloadAction<NormalizedData<number[]>>\n    ) {\n      state.items = action.payload.result;\n      state.isLoading = false;\n      state.error = null;\n    },\n    getOngoingGamesError(state, action: PayloadAction<string>) {\n      state.isLoading = false;\n      state.error = action.payload;\n    },\n  },\n  extraReducers: {\n    [challengeAiSuccess.type]: (\n      state,\n      action: PayloadAction<NormalizedData<number>>\n    ) => {\n      if (!state.items.includes(action.payload.result)) {\n        state.items.unshift(action.payload.result);\n      }\n    },\n    [createGameBySubscription.type]: (\n      state,\n      action: PayloadAction<NormalizedData<number>>\n    ) => {\n      if (!state.items.includes(action.payload.result)) {\n        state.items.unshift(action.payload.result);\n      }\n    },\n    [updateGameBySubscription.type]: (\n      state,\n      action: PayloadAction<NormalizedData<number>>\n    ) => {\n      if (!state.items.includes(action.payload.result)) {\n        state.items.unshift(action.payload.result);\n      }\n    },\n  },\n});\n\nexport const {\n  getOngoingGamesRequest,\n  getOngoingGamesSuccess,\n  getOngoingGamesError,\n} = ongoingGamesSlice.actions;\n\nexport default ongoingGamesSlice.reducer;\n\nexport const fetchOngoingGames = (): AppThunk<Promise<Game[]>> => (\n  dispatch\n) => {\n  dispatch(getOngoingGamesRequest());\n\n  return new Promise((resolve, reject) => {\n    ioClient.socket.get(\"/api/v1/game/playing\", (body: unknown, jwr: JWR) => {\n      if (jwr.statusCode === 200) {\n        const normalizedGames = normalize(body as Game[], [gameSchema]);\n        dispatch(getOngoingGamesSuccess(normalizedGames));\n\n        resolve(body as Game[]);\n      } else {\n        dispatch(getOngoingGamesError(body as string));\n        reject(jwr);\n      }\n    });\n  });\n};\n","/* eslint-disable no-param-reassign */\n/* eslint-disable import/no-cycle */\n\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { JWR } from \"sails.io.js\";\nimport { normalize } from \"normalizr\";\nimport { AppThunk } from \"../../app/store\";\nimport Game from \"../../interfaces/Game\";\nimport ioClient from \"../../services/ioClient\";\nimport gameSchema from \"../../normalizr/schemas/gameSchema\";\nimport ItemErrorPayload from \"../../interfaces/ItemErrorPayload\";\nimport NormalizedData from \"../../normalizr/interfaces/NormalizedData\";\n\ninterface SingleGameState {\n  [gameId: string]: {\n    isLoading: boolean;\n    error: string | null;\n  };\n}\n\nconst initialState: SingleGameState = {};\n\nconst singleGameSlice = createSlice({\n  name: \"singleGame\",\n  initialState,\n  reducers: {\n    getSingleGameRequest(state, action: PayloadAction<number>) {\n      state[action.payload] = {\n        isLoading: true,\n        error: null,\n      };\n    },\n    getSingleGameSuccess(state, action: PayloadAction<NormalizedData<number>>) {\n      state[action.payload.result] = {\n        isLoading: false,\n        error: null,\n      };\n    },\n    getSingleGameError(state, action: PayloadAction<ItemErrorPayload>) {\n      state[action.payload.itemId] = {\n        isLoading: false,\n        error: action.payload.error,\n      };\n    },\n  },\n  extraReducers: {},\n});\n\nexport const {\n  getSingleGameRequest,\n  getSingleGameSuccess,\n  getSingleGameError,\n} = singleGameSlice.actions;\n\nexport default singleGameSlice.reducer;\n\nexport const fetchGame = (id: number): AppThunk<Promise<Game>> => (\n  dispatch\n) => {\n  dispatch(getSingleGameRequest(id));\n\n  return new Promise((resolve, reject) => {\n    ioClient.socket.get(`/game/${id}`, (body: unknown, jwr: JWR) => {\n      if (jwr.statusCode === 200) {\n        const normalizedGame = normalize(body as Game, gameSchema);\n        dispatch(getSingleGameSuccess(normalizedGame));\n        resolve(body as Game);\n      } else {\n        dispatch(\n          getSingleGameError({\n            itemId: id,\n            error: body as string,\n          })\n        );\n        reject(jwr);\n      }\n    });\n  });\n};\n","/* eslint-disable no-param-reassign */\n/* eslint-disable import/no-cycle */\n\nimport { createSlice } from \"@reduxjs/toolkit\";\nimport {\n  loginSuccess,\n  registerSuccess,\n} from \"../current-user/currentUserSlice\";\n\ninterface AuthModalState {\n  isAuthModalVisible: boolean;\n}\n\nconst initialState: AuthModalState = {\n  isAuthModalVisible: false,\n};\n\nconst authModalSlice = createSlice({\n  name: \"authModal\",\n  initialState,\n  reducers: {\n    showAuthModal(state) {\n      state.isAuthModalVisible = true;\n    },\n    hideAuthModal(state) {\n      state.isAuthModalVisible = false;\n    },\n  },\n  extraReducers: {\n    [loginSuccess.type]: (state) => {\n      state.isAuthModalVisible = false;\n    },\n    [registerSuccess.type]: (state) => {\n      state.isAuthModalVisible = false;\n    },\n  },\n});\n\nexport const { showAuthModal, hideAuthModal } = authModalSlice.actions;\n\nexport default authModalSlice.reducer;\n","/* eslint-disable no-param-reassign */\n/* eslint-disable import/no-cycle */\n\nimport { createSlice } from \"@reduxjs/toolkit\";\nimport { challengeAiSuccess } from \"../challenge/challengeSlice\";\n\ninterface ChallengeAiModalState {\n  isChallengeAiModalVisible: boolean;\n}\n\nconst initialState: ChallengeAiModalState = {\n  isChallengeAiModalVisible: false,\n};\n\nconst challengeAiModalSlice = createSlice({\n  name: \"challengeAiModal\",\n  initialState,\n  reducers: {\n    showChallengeAiModal(state) {\n      state.isChallengeAiModalVisible = true;\n    },\n    hideChallengeAiModal(state) {\n      state.isChallengeAiModalVisible = false;\n    },\n  },\n  extraReducers: {\n    [challengeAiSuccess.type]: (state) => {\n      state.isChallengeAiModalVisible = false;\n    },\n  },\n});\n\nexport const {\n  showChallengeAiModal,\n  hideChallengeAiModal,\n} = challengeAiModalSlice.actions;\n\nexport default challengeAiModalSlice.reducer;\n","/* eslint-disable @typescript-eslint/no-unused-vars */\n/* eslint-disable @typescript-eslint/no-empty-interface */\n/* eslint-disable import/no-cycle */\n\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { JWR } from \"sails.io.js\";\nimport { normalize } from \"normalizr\";\nimport NormalizedData from \"../../normalizr/interfaces/NormalizedData\";\nimport { AppThunk } from \"../../app/store\";\nimport Game from \"../../interfaces/Game\";\nimport ioClient from \"../../services/ioClient\";\nimport gameSchema from \"../../normalizr/schemas/gameSchema\";\n\ninterface MoveState {}\n\nconst initialState: MoveState = {};\n\nconst moveSlice = createSlice({\n  name: \"move\",\n  initialState,\n  reducers: {\n    makeMoveRequest(_state, _action: PayloadAction<MoveRequestPayload>) {},\n    makeMoveSuccess(_state, _action: PayloadAction<NormalizedData<number>>) {},\n    makeMoveError(_state, _action: PayloadAction<string>) {},\n  },\n  extraReducers: {},\n});\n\nexport const {\n  makeMoveRequest,\n  makeMoveSuccess,\n  makeMoveError,\n} = moveSlice.actions;\n\nexport default moveSlice.reducer;\n\nexport interface MoveRequestPayload {\n  gameId: number;\n  move: string;\n}\n\nexport const makeMove = (\n  gameId: number,\n  move: string\n): AppThunk<Promise<Game>> => (dispatch) => {\n  dispatch(\n    makeMoveRequest({\n      gameId,\n      move,\n    })\n  );\n\n  return new Promise((resolve, reject) => {\n    ioClient.socket.post(\n      `/api/v1/board/game/${gameId}/move/${move}`,\n      {},\n      (body: unknown, jwr: JWR) => {\n        if (jwr.statusCode === 200) {\n          const normalizedGame = normalize(body as Game, gameSchema);\n\n          dispatch(makeMoveSuccess(normalizedGame));\n          resolve(body as Game);\n        } else {\n          dispatch(makeMoveError(body as string));\n          reject(jwr);\n        }\n      }\n    );\n  });\n};\n","/* eslint-disable import/no-cycle */\n/* eslint-disable @typescript-eslint/no-empty-interface */\n\nimport { createSlice } from \"@reduxjs/toolkit\";\nimport { AppThunk } from \"../../app/store\";\n\ninterface GameClockState {}\n\nconst initialState: GameClockState = {};\n\nconst gameClockSlice = createSlice({\n  name: \"gameClock\",\n  initialState,\n  reducers: {\n    oneSecondPassed() {},\n  },\n  extraReducers: {},\n});\n\nexport const { oneSecondPassed } = gameClockSlice.actions;\n\nexport default gameClockSlice.reducer;\n\nexport const startGameClock = (): AppThunk<void> => (dispatch) => {\n  setInterval(() => {\n    dispatch(oneSecondPassed());\n  }, 1000);\n};\n"],"sourceRoot":""}